title: Androidå›¾ç‰‡åº“--Glide Wikiä¸­æ–‡ç¿»è¯‘
date: 2016-01-24 10:32:54
description: Glide Wikiä¸­æ–‡ç¿»è¯‘ã€‚Glideæ˜¯ä¸€ä¸ªAndroidå›¾ç‰‡åº“ï¼Œç¡®åˆ‡åœ°è¯´åº”å½“å«ã€åª’ä½“æ¡†æ¶ã€ã€‚æ”¯æŒå›¾ç‰‡ã€Gifã€åŸç”Ÿè§†é¢‘çš„åŠ è½½ã€‚ä½¿ç”¨ç®€å•ï¼Œæ€§èƒ½ä¼˜å¼‚ï¼ŒGoogleæ¨èã€‚
categories:
- æŠ€æœ¯
tags:
- Android
- ä¸»æ¡†æ¶
---
## åº
æœ€è¿‘ï¼Œä¸€ç›´åœ¨æ£é¼“Glideè¿™ä¸ªå›¾ç‰‡åº“ï¼Œç¡®åˆ‡åœ°è¯´åº”å½“å«ã€åª’ä½“æ¡†æ¶ã€ã€‚ä¸ºäº†æ”¯æŒGifæ’­æ”¾ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨Glideä»£æ›¿äº†Universal Image Loaderã€‚èµ·åˆæˆ‘ä»¬æ‰“ç®—ä½¿ç”¨çš„æ˜¯Frescoæ–¹æ¡ˆï¼Œæœ€ç»ˆå› ä¸ºLibä½“ç§¯çš„é—®é¢˜æ”¾å¼ƒã€‚ä¸‡ä¸‡æ²¡æƒ³åˆ°apkçš„sizeè¿™ä¹ˆæ•æ„Ÿï¼Œå›½å¤–å¾ˆå¤šæ¨å¹¿æœåŠ¡æ˜¯æ ¹æ®apkä½“ç§¯æ”¶è´¹çš„ï¼Œ3Mä¸€ä¸ªé—¨æ§›ï¼Œ5Mä¸€ä¸ªé—¨æ§›ã€‚frescoå¼•å…¥ä¹‹åå³ä½¿proguardã€7zipï¼Œapkçš„å¤§å°ä¹Ÿå¢åŠ äº†1M+ï¼Œå¤šå¹³å°çš„osåº“æ˜¯ä¸ªå¤§å¤´ï¼Œç¬¬ä¸‰ä¸–ç•Œçš„åº”ç”¨å¸‚åœºè¿˜ä¸æ”¯æŒæŒ‰å¹³å°åˆ†å‘ğŸ˜“ã€‚ã€‚
Glideçš„ä½¿ç”¨è¿˜ä¸æ·±å…¥ï¼Œä»…ä»…åœç•™åœ¨Apiçš„èŒƒç•´ï¼Œä¸ºäº†è§£å†³bugï¼Œè·Ÿè¸ªäº†ä»£ç ï¼Œä¹Ÿæ˜¯äº‘é‡Œé›¾é‡Œã€‚ä¸å¾—ä¸è¯´ï¼ŒGlideæºç çš„è®¾è®¡ååˆ†NBï¼Œé¢å‘æ¥å£çš„ç†å¿µè´¯å½»çš„å¾ˆå½»åº•ï¼Œæ˜¯ä¸€ä¸ªå­¦ä¹ è®¾è®¡çš„å¥½demoã€‚
GitHubçš„READMEä½œä¸ºæœ€ç®€å•çš„å…¥é—¨è¶³å¤Ÿäº†ï¼Œä½†æ˜¯é‡åˆ°å…·ä½“é—®é¢˜è¿˜æ˜¯è¦ç†è§£ä¸€äº›è®¾è®¡æ€æƒ³çš„ï¼ŒGitHubä¸Šçš„Wikiæœ‰ä¸€ä»½ä¸é”™çš„æ–‡æ¡£ï¼Œå¯æƒœæœ¨æœ‰ä¸­æ–‡ï¼Œæ­£å¥½å­¦ä¹ çš„è¿‡ç¨‹ä¸­ç¿»è¯‘ä¸€ä¸‹ã€‚
åœ¨çœ‹wikiä¹‹å‰ï¼Œå¯ä»¥å…ˆçœ‹è¿™ä¸¤ç¯‡ä¸­æ–‡å…¥é—¨ï¼Œäº†è§£åŸºæœ¬çš„ç”¨æ³•ã€‚

* [Googleæ¨èçš„å›¾ç‰‡åŠ è½½åº“Glideä»‹ç»](http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/0327/2650.html)
* [Glide ä¸€ä¸ªä¸“æ³¨äºå¹³æ»‘æ»šåŠ¨çš„å›¾ç‰‡åŠ è½½å’Œç¼“å­˜åº“](http://www.jianshu.com/p/4a3177b57949)

æœ¬æ–‡æ˜¯åŸºäº**Glide 3.x**æ­£å¼ç‰ˆçš„[Wikiæ–‡æ¡£](https://github.com/bumptech/glide/wiki)çš„ç¿»è¯‘ï¼ˆåŸæ–‡ç¼–è¾‘æ—¥æœŸï¼š2015-2-9,18 revisionï¼Œå½“æ—¶Glide releaseçš„ç‰ˆæœ¬å·3.6.1ï¼‰ã€‚

ç¿»è¯‘Versionï¼š1.1 ç®€å•æ ¡å¯¹

### åè¯è§£é‡Š
Glideä¸­æœ‰ä¸€éƒ¨åˆ†å•è¯ï¼Œæˆ‘ä¸çŸ¥é“ç”¨ä»€ä¹ˆä¸­æ–‡å¯ä»¥ç¡®åˆ‡çš„è¡¨è¾¾å‡ºå«ä¹‰ï¼Œç”¨è‹±æ–‡å•è¯å¯èƒ½åœ¨è¡Œæ–‡ä¸­æ›´åŠ åˆé€‚ï¼Œè¿˜æœ‰ä¸€äº›è¯åœ¨Glideä¸­æœ‰ç‰¹åˆ«çš„å«ä¹‰ï¼Œæˆ‘ç†è§£çš„å¯èƒ½ä¹Ÿä¸æ·±å…¥ï¼Œè¿™é‡Œå…ˆè®°å½•ä¸€ä¸‹ã€‚

* Viewï¼š ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŒ‡Androidä¸­çš„ViewåŠå…¶å­ç±»æ§ä»¶ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰çš„ï¼‰ï¼Œå°¤å…¶æŒ‡ImageViewã€‚è¿™äº›æ§ä»¶å¯åœ¨ä¸Šé¢ç»˜åˆ¶Drawable
* Targetï¼š Glideä¸­é‡è¦çš„æ¦‚å¿µï¼Œç›®æ ‡ã€‚å®ƒå³å¯ä»¥æŒ‡å°è£…äº†ä¸€ä¸ªViewçš„Targetï¼ˆViewTargetï¼‰ï¼Œä¹Ÿå¯ä»¥ä¸åŒ…å«Viewï¼ˆSimpleTargetï¼‰ã€‚
* Drawableï¼š æŒ‡Androidä¸­çš„Drawableç±»æˆ–è€…å®ƒçš„å­ç±»ï¼Œå¦‚BitmapDrawableç­‰ã€‚æˆ–è€…Glideä¸­åŸºç¡€Drawableå®ç°çš„è‡ªå®šä¹‰Drawableï¼ˆå¦‚GifDrawableç­‰ï¼‰
* Request - åŠ è½½è¯·æ±‚ï¼Œå¯ä»¥æ˜¯ç½‘ç»œè¯·æ±‚æˆ–è€…å…¶ä»–ä»»ä½•ä¸‹è½½å›¾ç‰‡çš„è¯·æ±‚ï¼Œä¹Ÿæ˜¯Glideä¸­çš„ä¸€ä¸ªç±»ã€‚
* Modelï¼šæ•°æ®æºçš„æä¾›è€…ï¼Œå¦‚Urlï¼Œæ–‡ä»¶è·¯å¾„ç­‰ï¼Œå¯ä»¥ä»modelä¸­è·å–InputStreamã€‚
* Signatureï¼šç­¾åï¼Œå¯ä»¥å”¯ä¸€åœ°æ ‡è¯†ä¸€ä¸ªå¯¹è±¡ã€‚
* recycle()ï¼šGlideä¸­Resourceç±»æœ‰æ­¤æ–¹æ³•ï¼Œè¡¨ç¤ºè¯¥èµ„æºä¸è¢«å¼•ç”¨ï¼Œå¯ä»¥æ”¾å…¥æ± ä¸­ï¼ˆæ­¤æ—¶å¹¶æ²¡æœ‰é‡Šæ”¾ç©ºé—´ï¼‰ã€‚Androidä¸­Bitmapä¹Ÿæœ‰æ­¤æ–¹æ³•ï¼Œè¡¨ç¤ºé‡Šæ”¾Bitmapå ç”¨çš„å†…å­˜ã€‚

## ç›®å½•
* ä¸»ç›®å½•
* ç¼“å­˜æœºåˆ¶ä¸ç¼“å­˜å¤±æ•ˆ
* Glideé…ç½®
* è‡ªå®šä¹‰Target
* è°ƒè¯•ä¸é”™è¯¯å¤„ç†
* ä½¿ç”¨Glideä¸‹è½½è‡ªå®šä¹‰å¤§å°å›¾ç‰‡
* é›†æˆåº“-ä¸å…¶ä»–åº“ç›¸æ•´åˆ
* åœ¨åå°çº¿ç¨‹ä¸­åŠ è½½ä¸ç¼“å­˜æ•°æ®
* Glideä¸­çš„èµ„æºå¤ç”¨
* å¿«ç…§ï¼ˆSnapshotsï¼‰
* å›¾å½¢å˜æ¢ï¼ˆTransformationsï¼‰

---------

## ä¸»ç›®å½•

### æŠ¥å‘Šé—®é¢˜
å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥åœ¨[Githubä¸Šæå‡º](https://github.com/bumptech/glide/issues/)æˆ–è€…å‘é€e-mailåˆ°æˆ‘ä»¬çš„[é‚®ä»¶åˆ—è¡¨](https://groups.google.com/forum/#!forum/glidelibrary)ï¼Œä¹Ÿå¯ä»¥åœ¨IRC(Internet Relay Chat ç½‘ç»œä¸­ç»§èŠå¤©ï¼Ÿ)é¢‘é“ä¸Šè”ç³»æˆ‘ä»¬ï¼š[irc.freenode.net#glide-library](http://webchat.freenode.net/?channels=glide-library)ã€‚

### 3.0ç‰ˆæœ¬çš„æ–°ç‰¹æ€§
* æ”¯æŒGifåŠ¨ç”»çš„è§£ç  - ä¸åŠ è½½å›¾ç‰‡ç›¸åŒï¼Œåªè¦è°ƒç”¨Glide.with(...).load(...)ï¼Œå¦‚æœä½ åŠ è½½çš„å›¾ç‰‡æ˜¯ä¸€ä¸ªå¯ä»¥æ’­æ”¾çš„Gifï¼ŒGlideä¼šè‡ªåŠ¨åŠ è½½å®ƒå¹¶æ˜¾ç¤ºåœ¨ä¸€ä¸ªè‡ªå®šä¹‰çš„Drawableä¸Šï¼ˆæ³¨ï¼šGifDrawableï¼‰ã€‚æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥æ§åˆ¶çš„æ›´å¤šï¼Œæ¯”å¦‚

	```java
// ä½ æƒ³åŠ è½½Gifä¸ºä¸€å¼ é™æ€å›¾ç‰‡
Glide.with(context).load(...).asBitmap()ã€‚
// æˆ–è€…ä½ æƒ³åªæœ‰åŠ è½½å¯¹è±¡æ˜¯Gifæ—¶æ‰èƒ½åŠ è½½æˆåŠŸ
Glide.with(context).load(...).asGif()ã€‚
```

* æœ¬åœ°è§†é¢‘æ’­æ”¾æŠ€æœ¯ - é™¤äº†è§£ç Gifï¼ŒGlideä¹Ÿèƒ½è§£ç ä½ è®¾å¤‡ä¸Šçš„è§†é¢‘ï¼ˆvideoï¼‰ã€‚ä½¿ç”¨æ–¹æ³•å’ŒåŠ è½½gifç›¸åŒï¼ŒGlideæ”¯æŒæ‰€æœ‰Androidå¯ä»¥ç›´æ¥è§£ç çš„è§†é¢‘ã€‚
* æ”¯æŒç¼©ç•¥å›¾åŠ è½½ - æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å‡å°‘ç”¨æˆ·ç­‰å¾…çš„æ—¶é—´åˆä¸æƒ³ç‰ºç‰²å›¾ç‰‡çš„è´¨é‡ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶åŠ è½½å¤šå¼ å›¾ç‰‡åˆ°ä¸€ä¸ªViewä¸­ï¼Œå…ˆåŠ è½½ç¼©ç•¥å›¾ï¼ˆåªæœ‰viewçš„1/10å¤§å°ï¼‰ï¼Œç„¶åå†åŠ è½½ä¸€ä¸ªå®Œæ•´çš„å›¾åƒè¦†ç›–åœ¨ä¸Šé¢ã€‚ä½¿ç”¨ä¸‹é¢çš„ä»£ç 

	```java
Glide.with(yourFragment).load(yourUrl).thumbnail(0.1f).into(yourView)
```

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªRequeståˆ°`.thumbnail()`å‡½æ•°ä¸­ä½œä¸ºå‚æ•°ã€‚

* ä¸ç”Ÿå‘½å‘¨æœŸé›†æˆ - åŠ è½½è¯·æ±‚ç°åœ¨ä¼šè‡ªåŠ¨åœ¨onStopä¸­æš‚åœåœ¨ï¼ŒonStartä¸­é‡æ–°å¼€å§‹ã€‚ä¸ºäº†èŠ‚çº¦ç”µé‡ï¼ŒGifåŠ¨ç”»ä¹Ÿä¼šåœ¨onStopä¸­è‡ªåŠ¨æš‚åœã€‚æ­¤å¤–ï¼Œå½“è®¾å¤‡çš„è¿æ¥çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰å¤±è´¥çš„è¯·æ±‚ä¼šè‡ªåŠ¨é‡è¯•ï¼Œç¡®ä¿Glideä¸ä¼šå› ä¸ºä¸´æ—¶æ€§çš„è¿æ¥é—®é¢˜ï¼Œå¯¼è‡´è¯·æ±‚æ°¸è¿œå¤±è´¥ã€‚
* è½¬ç  - é™¤äº†è§£ç èµ„æºï¼ŒGlideçš„`.toBytes()`å’Œ`.transcode()`æ–¹æ³•å…è®¸ä½ åœ¨åå°æ­£å¸¸åœ°è·å–ã€è§£ç ã€å˜æ¢ä¸€å¼ å›¾ç‰‡ã€‚ä½ è¿˜å¯ä»¥åœ¨è¿™äº›è°ƒç”¨ä¸­æŠŠå›¾ç‰‡è½¬ç æˆæ›´æœ‰ç”¨çš„æ ¼å¼ï¼Œæ¯”å¦‚ï¼Œä¸Šä¼ ä¸€å¼ å¤§å°ä¸º250*250åƒç´ çš„ç”¨æˆ·å¤´åƒçš„å›¾ç‰‡bytesæ•°æ®ï¼Œä»£ç å¦‚ä¸‹

	```java
Glide.with(context)
    .load(â€œ/user/profile/photo/pathâ€)
    .asBitmap()
    .toBytes()
    .centerCrop()
    .into(new SimpleTarget<byte[]>(250, 250) {
        @Override
        public void onResourceReady(byte[] data, GlideAnimation anim) {
            // åœ¨æ­¤å¤„ï¼Œå°†bytesæ•°æ®ä¼ å…¥åå°çº¿ç¨‹ï¼Œå†ä¸Šä¼ ä»–ä»¬
        }
    });
```

* åŠ¨ç”» - Glide3.Xæ”¯æŒã€æ·¡å…¥æ·¡å‡ºã€åŠ¨ç”»ï¼ˆ`.crossFade()`ï¼‰å’Œviewçš„å±æ€§åŠ¨ç”»(`.animate(ViewPropertyAnimation.Animator)`)ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰Glide2.0å°±æ”¯æŒçš„android viewåŠ¨ç”»ã€‚
* æ”¯æŒ OkHttp å’Œ Volley - ç°åœ¨ä½ å¯ä»¥é€‰æ‹©ç”¨OkHttpã€Volleyæˆ–è€…é»˜è®¤çš„HttpUrlConnectionä½œä¸ºç½‘ç»œæ ˆã€‚OkHttpå’ŒVolleyå¯ä»¥é€šè¿‡æ·»åŠ å¯¹åº”çš„é›†æˆåº“(integration library)å’Œæ³¨å†Œç›¸åº”çš„`ModelLoaderFactory`æ¥å¼•å…¥ã€‚å…·ä½“æŸ¥çœ‹ReadMeæ–‡ä»¶ã€‚
* å…¶ä»– - å¯ä»¥ä½¿ç”¨Drawableå¯¹è±¡ä½œä¸ºåŠ è½½ä¸­çš„å ä½å›¾ã€è¯·æ±‚ä¼˜å…ˆçº§ã€è¦†ç›–è‡ªå®šä¹‰å®½å’Œé«˜ã€å¯ä»¥ç¼“å­˜å˜æ¢åçš„ç¼©ç•¥å›¾æˆ–è€…ç¼“å­˜åŸå§‹æ–‡ä»¶

### ä»2.0è¿ç§»åˆ°3.0
* å°†æ‰€æœ‰çš„`Glide.load()`æ›¿æ¢ä¸º`Glide.with([fragment/activity/context]).load()`ã€‚
* å°†æ‰€æœ‰çš„è‡ªå®šä¹‰çš„åŠ è½½è°ƒç”¨`Glide.load(url).into(new SimpleTarget(){ ... }).with(context)`æ›¿æ¢æˆ`Glide.with(context).load(url).into(new SimpleTarget(width, height) { ... })`ã€‚

### ç‰¹æ€§
é™¤äº†3.0å¼•å…¥çš„æ–°åŠŸèƒ½ï¼ŒGlideç»§æ‰¿äº†2.0çš„æ‰€æœ‰åŠŸèƒ½ï¼š

* åå°å›¾ç‰‡åŠ è½½
* å¦‚æœä½ ä½¿ç”¨äº†listviewçš„å¤ç”¨æœºåˆ¶ï¼Œé‚£ä¹ˆGlideä¼šè‡ªåŠ¨å–æ¶ˆä½œä¸šï¼ˆjobï¼‰
* å†…å­˜å’Œç£ç›˜ç¼“å­˜
* Bitmapå’Œèµ„æºæ± æ¥å‡å°‘å†…å­˜æŠ–åŠ¨
* æ”¯æŒä»»æ„çš„å›¾åƒå˜æ¢

---------

## ç¼“å­˜æœºåˆ¶ä¸ç¼“å­˜å¤±æ•ˆ
ç¼“å­˜å¤±æ•ˆæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„è¯é¢˜ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œä½ å°½å¯èƒ½ä¸è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚è¿™ä¸€èŠ‚ä¸»è¦æ˜¯è®©ä½ ç²—ç•¥çš„äº†è§£ä¸€ä¸‹Glideä¸­cacheçš„keyæ˜¯å¦‚ä½•ç”Ÿæˆï¼Œä»¥åŠæä¾›ä¸€äº›å…³äºå¦‚ä½•åˆç†åˆ©ç”¨ç¼“å­˜çš„æç¤ºã€‚
### ç¼“å­˜çš„key
`DiskCacheStrategy.RESULT`ç£ç›˜ç¼“å­˜ç­–ç•¥ï¼ˆæ³¨ï¼šæˆ‘ä»¬é…ç½®çš„ä¸€ç§ç£ç›˜ç¼“å­˜ç­–ç•¥ï¼‰ä½¿ç”¨çš„keyç”±ä»¥ä¸‹å››ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š

* DataFetcherçš„æ–¹æ³•`getId()`è¿”å›çš„å­—ç¬¦ã€‚å…¸å‹åœ°ï¼ŒDataFetcherä»…ä»…è¿”å›ç”±æ•°æ®Modelçš„`toString()`æ–¹æ³•å¾—åˆ°çš„å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœModelæ˜¯ä¸€ä¸ª**URL**ï¼Œé‚£ä¹ˆä¼šè¿”å›URLçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœModelæ˜¯æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆä¼šè¿”å›æ–‡ä»¶çš„**è·¯å¾„**ã€‚ã€‚ã€‚
* å®½å’Œé«˜ã€‚å¦‚æœä½ è°ƒç”¨è¿‡override(width,height)æ–¹æ³•ï¼Œé‚£ä¹ˆå°±æ˜¯æ˜¯å®ƒä¼ å…¥çš„å€¼ã€‚æ²¡æœ‰è°ƒç”¨è¿‡ï¼Œé»˜è®¤æ˜¯é€šè¿‡**Target**çš„`getSize()`æ–¹æ³•è·å¾—è¿™ä¸ªå€¼ã€‚
* å„ç§ç¼–ç å™¨ã€è§£ç å™¨çš„`getId()`æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²ã€‚è¿™äº›ç¼–ç å™¨ã€è§£ç å™¨ç”¨äºåŠ è½½å’Œç¼“å­˜ä½ çš„å›¾ç‰‡ã€‚ä»…æœ‰å“ªäº›å †bytesæ•°æ®æœ‰å½±å“çš„ç¼–ç å™¨ã€è§£ç å™¨æ‰ä¼šæœ‰è¿™äº›`id`å€¼ã€‚æ¯”å¦‚ï¼Œä½ åªæœ‰ä¸€ä¸ªå°†bytesæ•°æ®å†™å…¥ç£ç›˜çš„ç¼–ç å™¨ï¼Œé‚£ä¹ˆå®ƒå°±æ²¡æœ‰idå€¼ï¼Œå› ä¸ºä¸ç®¡æ€æ ·å®ƒéƒ½ä¸ä¼šä¿®æ”¹æ•°æ®ã€‚
* å¯é€‰åœ°ï¼Œä½ å¯ä»¥ä¸ºå›¾ç‰‡åŠ è½½æä¾›ç­¾å(Signature)ï¼Œè¯·çœ‹ä¸‹é¢çš„ç¼“å­˜å¤±æ•ˆéƒ¨åˆ†ã€‚

æ‰€æœ‰çš„è¿™äº›keyï¼Œä»¥ç‰¹å®šçš„é¡ºåºè®¡ç®—å‡ºhashå€¼ï¼Œå¹¶å°†è¿™ä¸ªå€¼ä½œä¸ºä¿å­˜å›¾ç‰‡åˆ°ç£ç›˜ä¸Šçš„å”¯ä¸€ä¸”å®‰å…¨çš„æ–‡ä»¶åã€‚

### ç¼“å­˜å¤±æ•ˆ
ç”±äºæ–‡ä»¶åæ˜¯hashå€¼ï¼Œæ²¡æœ‰ç®€ä¾¿çš„æ–¹å¼åˆ é™¤ç£ç›˜ä¸ŠæŸä¸ªç‰¹å®šurlæˆ–è€…æ–‡ä»¶è·¯å¾„çš„æ‰€æœ‰ç¼“å­˜æ–‡ä»¶ã€‚å¦‚æœä»…ä»…ç¼“å­˜åŸæ–‡ä»¶ï¼Œé—®é¢˜å¯èƒ½è¿˜æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯Glideä¼šç¼“å­˜ç¼©ç•¥å›¾ï¼Œå„ç§å˜æ¢åçš„å›¾ç‰‡ï¼Œæ‰€æœ‰è¿™äº›ç¼“å­˜éƒ½ä¼šäº§ç”Ÿæ–°æ–‡ä»¶ã€‚è·Ÿè¸ªå’Œåˆ é™¤æ‰€æœ‰æ–‡ä»¶æ˜¯ååˆ†å›°éš¾çš„ã€‚

### è‡ªå®šä¹‰ç¼“å­˜å¤±æ•ˆ
é€šå¸¸æƒ…å†µä¸‹æ”¹å˜ç¼“å­˜çš„æ ‡å¿—ï¼ˆkeyï¼‰æ˜¯å›°éš¾çš„ã€‚Glideæä¾›äº†`signature()`APIæ¥æ··å…¥å…¶ä»–æ•°æ®ï¼Œå¸®åŠ©ä½ æ§åˆ¶ç¼“å­˜çš„keyã€‚ç­¾åï¼ˆSignatureï¼‰å¯¹äºå¤šåª’ä½“æˆ–è€…æœ‰ç‰ˆæœ¬ä¿¡æ¯çš„å†…å®¹æ¥è¯´éƒ½å¾ˆæœ‰ç”¨ã€‚

* åª’ä½“åº“å†…å®¹ - å¯¹äºåª’ä½“åº“å†…å®¹ï¼Œä½ å¯ä»¥ä½¿ç”¨Glideçš„`MediaStoreSignature`ç±»ä½œä¸ºç­¾åï¼Œ MediaStoreSignatureç±»å…è®¸ä½ æ··å…¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´ã€mimeç±»å‹ã€åª’ä½“åº“çš„æ–¹å‘(orientation?)è¿™äº›å€¼ä½œä¸ºç¼“å­˜çš„keyï¼Œè¿™ä¸‰ä¸ªå€¼è¶³ä»¥è®©ä½ å¯é çš„æ•æ‰åˆ°ä»»ä½•ä¿®æ”¹å’Œæ›´æ–°ï¼Œä½¿ä½ å¯ä»¥ç¼“å­˜åª’ä½“åº“çš„ç¼©ç•¥å›¾.?
* æ–‡ä»¶ - ä½ å¯ä»¥ä½¿ç”¨`StringSignature`æ··å…¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´
* url - è™½ç„¶ä½¿urlå¤±æ•ˆæœ€å¥½çš„æ–¹å¼æ˜¯å½“å†…å®¹å˜åŒ–æ—¶ï¼ŒæœåŠ¡å™¨ä¿®æ”¹urlå¹¶æ›´æ–°å®¢æˆ·ç«¯ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ç”¨`StringSignature`æ··å…¥ä»»æ„çš„å…ƒæ•°æ®ï¼ˆå¦‚ç‰ˆæœ¬å·ï¼‰æ¥ä½¿ç¼“å­˜å¤±æ•ˆã€‚

ä½¿ç”¨String SignatureåŠ è½½æ•°æ®å¾ˆç®€å•ï¼š

```java
Glide.with(yourFragment)
    .load(yourFileDataModel)
    .signature(new StringSignature(yourVersionMetadata))
    .into(yourImageView);
```

åª’ä½“åº“Signatureå¯ä»¥ç›´æ¥ä½¿ç”¨ä»MeidaStore(æ³¨ï¼šä¸€ä¸ªandroid apiï¼‰è·å¾—çš„æ•°æ®

```java
Glide.with(fragment)
    .load(mediaStoreUri)
    .signature(new MediaStoreSignature(mimeType, dateModified, orientation))
    .into(view);
```

ä½ è¿˜å¯ä»¥é€šè¿‡å®ç°`key`æ¥å£æ¥è‡ªå®šä¹‰ç­¾åï¼Œç¡®ä¿å®ç°äº†`equals()`, `hashCode()`å’Œ`updateDiskCacheKey()`è¿™å‡ ä¸ªæ–¹æ³•

```java
public class IntegerVersionSignature implements Key {
    private int currentVersion;
 
    public IntegerVersionSignature(int currentVersion) {
         this.currentVersion = currentVersion;
    } 
 
    @Override 
    public boolean equals(Object o) {
        if (o instanceof IntegerVersionSignature) {
            IntegerVersionSignature other = (IntegerVersionSignature) o;
            return currentVersion = other.currentVersion;
        } 
        return false; 
    } 
 
    @Override 
    public int hashCode() { 
        return currentVersion;
    } 
 
    @Override 
    public void updateDiskCacheKey(MessageDigest md) {
        messageDigest.update(ByteBuffer.allocate(Integer.SIZE).putInt(signature).array());
    } 
} 
```
è¯·ç‰¢è®°ï¼šä¸ºäº†é¿å…æ€§èƒ½ä¸‹é™ï¼Œè¯·åœ¨åå°çº¿ç¨‹ä¸­æ‰¹é‡åŠ è½½ç‰ˆæœ¬å…ƒæ•°æ®(metaDataï¼Œæ³¨ï¼šä¸€èˆ¬æŸ¥è¯¢æ•°æ®åº“è·å¾—)ï¼Œåªæœ‰è¿™æ ·ï¼Œæ‰èƒ½ç¡®ä¿å½“ä½ æƒ³åŠ è½½å›¾ç‰‡çš„æ—¶å€™ï¼Œè¿™äº›å€¼æ˜¯å¯ç”¨çš„ã€‚

å¦‚æœè¿™äº›æ–¹æ³•éƒ½å¤±è´¥äº†ï¼Œæ¯”å¦‚ï¼Œä½ ä¸èƒ½æ”¹å˜æ ‡è¯†ç¬¦ï¼Œä¹Ÿä¸èƒ½è·Ÿè¸ªä¸€ä¸ªåˆç†çš„ç‰ˆæœ¬å·ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨`diskCacheStrategy()`å’Œ`DiskCacheStrategy.NONE.`æ¥å®Œå…¨å…³é—­ç£ç›˜ç¼“å­˜ã€‚

---------

## é…ç½®

### æ‡’åŠ è½½é…ç½®
ä»Glide3.5å¼€å§‹ï¼Œä½ å¯ä»¥ä½¿ç”¨`GlideModule`æ¥å£æ¥æ‡’åŠ è½½é…ç½®Glideä»¥åŠæ³¨å†Œç»„ä»¶ï¼ˆå¦‚`ModelLoaders`)ï¼Œè¿™äº›é…ç½®å°†ä¼šåœ¨ç¬¬ä¸€ä¸ªGlideè¯·æ±‚å‘èµ·çš„æ—¶å€™è¢«è°ƒç”¨ã€‚

### åˆ›å»ºä¸€ä¸ªGlideModule
ä¸ºäº†ä½¿ç”¨å’Œæ³¨å†ŒGlideModuleï¼Œé¦–å…ˆéœ€è¦å®ç°è¯¥æ¥å£ï¼ŒåŠ å…¥ä½ çš„é…ç½®å’Œç»„ä»¶ã€‚

```java
package com.mypackage; 
 
public class MyGlideModule implements GlideModule { 
    @Override public void applyOptions(Context context, GlideBuilder builder) {
        // Apply options to the builder here. 
    } 
 
    @Override public void registerComponents(Context context, Glide glide) {
        // register ModelLoaders here. 
    } 
} 
```

ç„¶åï¼Œæ·»åŠ ä½ çš„å®ç°ç±»åˆ°`proguard.cfg`æ–‡ä»¶ä¸­ï¼Œè®©ä½ çš„moduleå¯ä»¥è¢«åå°„è°ƒç”¨åˆ°ã€‚è¿™ä¸ªæ€§èƒ½å¼€æ”¯å¾ˆå°‘ï¼Œå› ä¸ºæ¯ä¸ªmoduleåªä¼šåœ¨Glideç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å®ä¾‹åŒ–ä¸€æ¬¡ã€‚

```xml
-keepnames class com.mypackage.MyGlideModule
# or more generally:
#-keep public class * implements com.bumptech.glide.module.GlideModule
```

æœ€åï¼Œæ·»åŠ meta-dataæ ‡è®°åˆ°`AndroidManifest.xml`ï¼Œé‚£æ ·Glideæ‰èƒ½æ‰¾åˆ°å®ƒã€‚

```xml
<manifest ...>
    <!-- ... permissions -->
    <application ...>
        <meta-data
            android:name="com.mypackage.MyGlideModule"
            android:value="GlideModule" />
        <!-- ... activities and other components -->
    </application>
</manifest>
```

ä½ å¯ä»¥å®ç°ä»»æ„ä¸ª`GlideModule`ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªéƒ½è¦æ·»åŠ åˆ°`proguard.cfg`ï¼Œè€Œä¸”æ¯ä¸€ä¸ªGlideModuleéƒ½è¦åœ¨manifestæœ‰è‡ªå·±çš„meta-dataæ ‡è®°ã€‚

### Libraryå·¥ç¨‹
Libraryå·¥ç¨‹å¯èƒ½å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª`GlideModule`ã€‚å½“æˆ‘ä»¬ä½¿ç”¨Gradleï¼ˆæˆ–è€…ä»»ä½•æ”¯æŒmanifeståˆå¹¶çš„æ„å»ºå·¥å…·ï¼‰æ„å»ºappæ—¶ï¼Œå¦‚æœæˆ‘ä»¬æ‰€ä¾èµ–çš„Libraryå·¥ç¨‹çš„manifestä¸­å«æœ‰moduleï¼Œé‚£ä¹ˆè¿™äº›moduleä¼šè‡ªåŠ¨å¹¶å…¥åˆ°appä¸­ã€‚å¦‚æœæ„å»ºå·¥å…·ä¸æ”¯æŒmanifeståˆå¹¶ï¼Œé‚£ä¹ˆè¿™äº›libraryå·¥ç¨‹ä¸­çš„moduleå¿…é¡»æ‰‹åŠ¨æ·»åŠ åˆ°ä½ appçš„manifestä¸­ã€‚

### GlideModuleå†²çª
è™½ç„¶Glideå…è®¸æ¯ä¸ªappæ³¨å†Œå¤šä¸ª`Glidemodule`ï¼Œä½†æ˜¯ä¸ä¼šä»¥æŸç§ç‰¹å®šçš„é¡ºåºè°ƒç”¨è¿™äº›moduleã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çš„appä¸­å¤šä¸ª`GlideModules`æˆ–è€…ä¾èµ–çš„libraryå·¥ç¨‹ä¸­æœ‰å¤šä¸ª`GlideModules`ï¼Œä½ å¿…é¡»è´Ÿè´£é¿å…ä»–ä»¬ä¹‹é—´çš„å†²çªã€‚
å¦‚æœå†²çªä¸å¯é¿å…ï¼Œappåº”è¯¥å®šä¹‰è‡ªå·±çš„é»˜è®¤moduleï¼Œè¿™ä¸ªmoduleéœ€è¦æ‰‹åŠ¨è§£å†³è¿™äº›å†²çªï¼Œæä¾›æ‰€æœ‰Libraryå·¥ç¨‹æ‰€éœ€è¦çš„ä¾èµ–ã€‚ä½¿ç”¨Gradleçš„å¼€å‘è€…ï¼Œæˆ–è€…ä½¿ç”¨manifeståˆå¹¶çš„å¼€å‘è€…ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ ‡ç­¾æ¥æ’é™¤å†²çªçš„moduleã€‚

```xml
<meta-data android:name=â€com.mypackage.MyGlideModuleâ€ tools:node=â€removeâ€ />
```

### å…¨å±€é…ç½®
ä½ å¯ä»¥é…ç½®ä¸€äº›ä½œç”¨äºæ‰€æœ‰è¯·æ±‚çš„å…¨å±€æ€§é…ç½®é¡¹ã€‚è¯·ä½¿ç”¨`GlideModule#applyOptions`æ–¹æ³•ä¸­ï¼ˆæ³¨ï¼šä½œä¸ºå‚æ•°ï¼‰æä¾›ç»™ä½ çš„`GlideBuilder`æ¥é…ç½®ã€‚æœ¬èŠ‚ä»£ç ç¤ºä¾‹ä¸­çš„`builder`å°±æ˜¯ä¸€ä¸ªGlideModuleå¯¹è±¡ã€‚

### ç£ç›˜ç¼“å­˜
ä½ å¯ä»¥ä½¿ç”¨`GlideBuilder`çš„`setDiskCache()`æ–¹æ³•è®¾ç½®ç£ç›˜ç¼“å­˜çš„ä½ç½®ã€å¤§å°ï¼ˆæœ€å¤§å€¼ï¼‰ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`DiskCacheAdapter`å½»åº•å…³é—­ç¼“å­˜ï¼Œæˆ–è€…è‡ªå·±å®ç°`DiskCache`æ¥å£æ¥æ¢æ‰é»˜è®¤å®ç°ã€‚ç£ç›˜ç¼“å­˜ç”±`DiskCache.Factory`æ¥å£çš„å®ä¾‹åœ¨åå°çº¿ç¨‹ä¸­åˆ›å»ºï¼Œä½¿ç”¨åå°çº¿ç¨‹å¯ä»¥é¿å…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­å‡ºç°é—®é¢˜ã€‚
Glideé»˜è®¤ä½¿ç”¨`InternalCacheDiskCacheFactory`ç±»å»ºç«‹ç£ç›˜ç¼“å­˜ã€‚è¿™ä¸ªå†…éƒ¨ç¼“å­˜å·¥å‚ï¼ˆinternal cache factoryï¼‰ä¼šæŠŠç£ç›˜ç¼“å­˜æ”¾åˆ°åº”ç”¨ç¨‹åºçš„å†…éƒ¨ç¼“å­˜ç›®å½•ä¸­ï¼Œå¹¶ä¸”è®¾ç½®æœ€å¤§ç©ºé—´æ˜¯250MBï¼Œä½¿ç”¨å†…éƒ¨ç¼“å­˜çš„ç›®å½•è€Œä¸æ˜¯SDå¡çš„å¤–éƒ¨ç›®å½•æ„å‘³ç€å…¶ä»–åº”ç”¨ç¨‹åºæ— æ³•è®¿é—®åˆ°ä½ ä¸‹è½½çš„å›¾ç‰‡ã€‚å…·ä½“è¯·æŸ¥çœ‹Androidçš„[å­˜å‚¨é€‰é¡¹ç›¸å…³æ–‡æ¡£](http://developer.android.com/intl/zh-cn/guide/topics/data/data-storage.html#filesInternal)ã€‚

#### å¤§å°
ä½¿ç”¨`InternalCacheDiskCacheFactory`è®¾ç½®ç£ç›˜ç¼“å­˜å¤§å°

```java
builder.setDiskCache(
  new InternalCacheDiskCacheFactory(context, yourSizeInBytes));
```

#### ä½ç½®
ä¹Ÿå¯ä»¥è®¾ç½®ç£ç›˜ç¼“å­˜ä½ç½®
ä½ å¯ä»¥ä½¿ç”¨`InternalCacheDiskCacheFactory `æ¥æŠŠä½ çš„ç£ç›˜ç¼“å­˜æ”¾åˆ°åº”ç”¨ç¨‹åºç§æœ‰çš„å†…éƒ¨å­˜å‚¨ç›®å½•ä¸­ï¼š

```java
builder.setDiskCache(
  new InternalCacheDiskCacheFactory(context, cacheDirectoryName, yourSizeInBytes));
```
è¿˜å¯ä»¥ç”¨`ExternalCacheDiskCacheFactory `æ¥æŠŠä½ çš„ç£ç›˜ç¼“å­˜æ”¾åˆ°sdå¡çš„å…¬å…±ç¼“å­˜ç›®å½•ä¸Šã€‚

```java
builder.setDiskCache(
  new ExternalCacheDiskCacheFactory(context, cacheDirectoryName, yourSizeInBytes));
```
å¦‚æœä½ æƒ³ç”¨å…¶ä»–è‡ªå®šä¹‰çš„è·¯å¾„ï¼Œå¯ä»¥ç”¨`DiskLruCacheFactory`ç±»çš„æ„é€ å‡½æ•°æ¥å®ç°ã€‚

```java
// If you can figure out the folder without I/O: 
// Calling Context and Environment class methods usually do I/O. 
builder.setDiskCache( 
  new DiskLruCacheFactory(getMyCacheLocationWithoutIO(), yourSizeInBytes)); 
 
// In case you want to specify a cache folder ("glide"): 
builder.setDiskCache( 
  new DiskLruCacheFactory(getMyCacheLocationWithoutIO(), "glide", yourSizeInBytes)); 
 
// In case you need to query the file system while determining the folder: 
builder.setDiskCache(new DiskLruCacheFactory(new CacheDirectoryGetter() { 
    @Override public File getCacheDirectory() {
        return getMyCacheLocationBlockingIO(); 
    } 
}), yourSizeInBytes); 
```
æ³¨æ„ï¼šè¯·ç‰¢è®°ï¼Œå†™æ­»ä»»ä½•å€¼éƒ½ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå°¤å…¶æ˜¯ç›®å½•çš„è·¯å¾„ï¼Œå› ä¸ºè‡ªAndroid4.2å¼€å§‹ï¼Œæ”¯æŒå•è®¾å¤‡å¤šç”¨æˆ·ã€‚

å¦‚æœä½ æƒ³å®Œå…¨æ§åˆ¶ç¼“å­˜çš„åˆ›å»ºï¼Œå¯ä»¥è‡ªå·±å®ç°`DiskCache.Factory `æ¥å£ï¼Œä½¿ç”¨`DiskLruCacheWrapper`å¯ä»¥åœ¨ä½ æƒ³è¦çš„ä½ç½®åˆ›å»ºä¸€ä¸ªæ–°çš„ç¼“å­˜ã€‚

```java
builder.setDiskCache(new DiskCache.Factory() { 
    @Override public DiskCache build() { 
        File cacheLocation = getMyCacheLocationBlockingIO();
        cacheLocation.mkdirs();
        return DiskLruCacheWrapper.get(cacheLocation, yourSizeInBytes);
    } 
}); 
```

### å†…å­˜ç¼“å­˜å’Œç¼“å­˜æ± 
`GlideBuilder`ç±»å…è®¸ä½ è®¾ç½®å†…å­˜ç¼“å­˜å¤§å°ï¼Œè€Œä¸”å¯ä»¥å®ç°è‡ªå®šä¹‰çš„`MemoryCache`å’Œ`BitmapPool`ã€‚

#### å¤§å°
é»˜è®¤å¤§å°æ˜¯ç”±`MemorySizeCalculator`ç±»å†³å®šçš„ã€‚MemorySizeCalculatorç±»ä¼šè€ƒè™‘è¯¥è®¾å¤‡çš„å±å¹•å¤§å°ã€å¯ç”¨å†…å­˜æ¥è®¡ç®—å‡ºä¸€ä¸ªåˆç†çš„é»˜è®¤å€¼ã€‚å¦‚æœä½ æƒ³è°ƒæ•´è¿™ä¸ªé»˜è®¤å€¼ï¼Œè¯·æ„å»ºè‡ªå·±çš„å®ä¾‹ã€‚

```java
MemorySizeCalculator calculator = new MemorySizeCalculator(context);
int defaultMemoryCacheSize = calculator.getMemoryCacheSize();
int defaultBitmapPoolSize = calculator.getBitmapPoolSize();
```
å¦‚æœä½ æƒ³åœ¨åº”ç”¨çš„æŸä¸ªé˜¶æ®µåŠ¨æ€è°ƒæ•´Glideçš„å†…å­˜å ç”¨ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ª`MemoryCategory`å¹¶ä½¿ç”¨`setMemoryCategory()`æ–¹æ³•ä¼ å…¥Glideä¸­ï¼š

```java
Glide.get(context).setMemoryCategory(MemoryCategory.HIGH);
```

#### å†…å­˜ç¼“å­˜
Glideçš„å†…å­˜ç¼“å­˜ä¼šåœ¨å†…å­˜ä¸­æŒæœ‰èµ„æºï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸è¿›è¡ŒIOæ“ä½œè€Œå¿«é€Ÿè·å¾—å¯ç”¨èµ„æºã€‚
ä½ å¯ä»¥ä½¿ç”¨`GlideBuilder`çš„`setMemoryCache()`æ–¹æ³•è®¾ç½®å¤§å°ï¼Œæˆ–è€…è®¾ç½®ä½ å…³äºå†…å­˜ç¼“å­˜çš„è‡ªå®šä¹‰å®ç°ï¼ˆè‡ªå®šä¹‰ç±»ï¼‰ã€‚`LruResourceCache`ç±»æ˜¯Glideçš„é»˜è®¤å®ç°ã€‚ä½ å¯ä»¥é€šè¿‡`LruResourceCache`çš„æ„é€ å‡½æ•°æ¥é…ç½®å†…å­˜å ç”¨çš„bytesçš„æœ€å¤§å€¼ã€‚

```java
builder.setMemoryCache(new LruResourceCache(yourSizeInBytes));
```

#### Bitmapæ± 
Glideçš„Bitmapæ± ä¸»è¦ä½œç”¨æ˜¯ï¼Œå¯ä»¥è®©å„ç§å°ºå¯¸çš„Bitmapè¢«å¤ç”¨ï¼Œå¯ä»¥å¯è§‚åœ°å‡å°‘ç”±åƒåœ¾å›æ”¶å¼•èµ·çš„å†…å­˜æŠ–åŠ¨ã€‚åœ¨è§£ç å›¾ç‰‡æ—¶ï¼Œéœ€è¦ç»™åƒç´ æ•°ç»„åˆ†é…ç©ºé—´ï¼Œè¿™ä¼šè§¦å‘åƒåœ¾å›æ”¶ã€‚
ä½ å¯ä»¥ä½¿ç”¨`GlideBuilder`çš„`setBitmapPool()`æ–¹æ³•è®¾ç½®å¤§å°ï¼Œæˆ–è€…è®¾ç½®ä½ å…³äºBitmapæ± çš„è‡ªå®šä¹‰å®ç°ï¼Œ`LruBitmapPool`ç±»æ˜¯Glideçš„é»˜è®¤å®ç°ã€‚LruBitmapPoolç±»ä½¿ç”¨äº†LRUç®—æ³•ç»´æŠ¤æœ€è¿‘æœ€å¸¸ä½¿ç”¨çš„Bitmapçš„å°ºå¯¸ã€‚ä½ å¯ä»¥é€šè¿‡`LruBitmapPool`çš„æ„é€ å‡½æ•°é…ç½®å†…å­˜å ç”¨çš„bytesçš„æœ€å¤§å€¼ã€‚

```java
builder.setBitmapPool(new LruBitmapPool(sizeInBytes));
```

### Bitmapæ ¼å¼
`GlideBuilder` ç±»ä¹Ÿå…è®¸ä½ é…ç½®ä¸€ä¸ªAppå…¨å±€ä½¿ç”¨çš„Bitmapçš„Configå±æ€§ã€‚
Glideé»˜è®¤ä½¿ç”¨RGB_565ï¼Œå› ä¸ºå®ƒæ¯ä¸ªåƒç´ åªéœ€è¦2bytesï¼ˆ16bitï¼‰çš„ç©ºé—´ï¼Œå®ƒä»…éœ€è¦é«˜è´¨é‡å›¾ç‰‡ï¼ˆæ—¢ç³»ç»Ÿé»˜è®¤çš„`ARGB_8888 `ï¼‰ä¸€åŠçš„å†…å­˜ç©ºé—´ã€‚ä½†æ˜¯ï¼Œè¿™å¯¹äºæŸäº›å›¾ç‰‡è¿™å¯èƒ½ä¼šå‡ºç°ã€æ¡å¸¦ã€çš„é—®é¢˜ï¼Œè€Œä¸”å®ƒä¹Ÿä¸æ”¯æŒé€æ˜åº¦ã€‚
å¦‚æœåœ¨ä½ çš„åº”ç”¨ä¸­ã€æ¡å¸¦ã€æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼Œæˆ–è€…ä½ éœ€è¦å°½å¯èƒ½å¥½çš„å›¾ç‰‡è´¨é‡ï¼Œä½ å¯ä»¥ä½¿ç”¨`GlideBuilder`çš„`setDecodeFormat`æ–¹æ³•è®¾ç½®DecodeFormat.ALWAYS_ARGB_8888ä½œä¸ºé¦–é€‰é…ç½®ã€‚

```java
builder.setDecodeFormat(DecodeFormat.ALWAYS_ARGB_8888);
```

---------

## è‡ªå®šä¹‰ç›®æ ‡ï¼ˆTargetsï¼‰
é™¤äº†å¯ä»¥åŠ è½½å›¾åƒï¼Œè§†é¢‘å‰§ç…§ï¼ŒgifåŠ¨ç”»åˆ°Viewä¸­ï¼Œä½ è¿˜å¯ä»¥åŠ è½½ä»–ä»¬åˆ°å®ç°äº†Targetæ¥å£çš„è‡ªå®šä¹‰ç›®æ ‡ä¸­ã€‚

### SimpleTarget
å¦‚æœä½ åªæ˜¯æƒ³åŠ è½½ä¸€ä¸ªBitmapï¼Œå¹¶ä¸æƒ³ç›´æ¥å±•ç¤ºç»™ç”¨æˆ·è€Œæ˜¯æœ‰ä¸€äº›ç‰¹æ®Šç”¨é€”ï¼Œæ¯”å¦‚åœ¨é€šçŸ¥æ ä¸­æ˜¾ç¤ºæˆ–è€…ä½œä¸ºå¤´åƒä¸Šä¼ ã€‚
Glideä¹Ÿå¯ä»¥åšåˆ°ã€‚
SimpleTargetä¸ºTargetæ¥å£æä¾›äº†å¤§éƒ¨åˆ†çš„é»˜è®¤å®ç°ã€‚ä½ å¯ä»¥ä¸“æ³¨äºå¤„ç†åŠ è½½çš„ç»“æœã€‚
ä¸ºäº†ä½¿ç”¨SimpleTargetï¼Œä½ éœ€è¦åœ¨å®ƒçš„æ„é€ å‡½æ•°ä¸­æä¾›ä½ è¦åŠ è½½çš„èµ„æºçš„å®½å’Œé«˜ï¼ˆå•ä½åƒç´ ï¼‰ï¼Œä½ è¿˜éœ€è¦å®ç°` onResourceReady(T resource, GlideAnimation animation)`æ–¹æ³•ã€‚
ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨SimpleTargetçš„ä¾‹å­å¦‚ä¸‹ï¼š

```java
int myWidth = 512;
int myHeight = 384;
 
Glide.with(yourApplicationContext)) 
    .load(youUrl) 
    .asBitmap() 
    .into(new SimpleTarget<Bitmap>(myWidth, myHeight) {
        @Override 
        public void onResourceReady(Bitmap bitmap, GlideAnimation anim) {
            // Do something with bitmap here. 
        } 
    }; 
```

#### ä¸€äº›è­¦å‘Š
æ­£å¸¸æƒ…å†µä¸‹ï¼Œä½ åŠ è½½ä¸€ä¸ªèµ„æºä¼šæŠŠä»–ä»¬æ”¾åˆ°viewä¸­ã€‚å½“ä½ çš„Activityæˆ–è€…Fragmentè¢«pauseæˆ–è€…destroyæ—¶ï¼ŒGlideä¼šæš‚åœæˆ–å–æ¶ˆåŠ è½½ï¼Œç¡®ä¿ä½ ä¸ä¼šåŠ è½½é‚£äº›æ ¹æœ¬ä¸ä¼šæ˜¾ç¤ºçš„èµ„æºã€‚
å¯æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨SimpleTargetçš„æ—¶å€™ï¼Œè¿™å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çš„è¡Œä¸ºã€‚æ‰€ä»¥ï¼Œå½“ä½ è°ƒç”¨`Glide.with(context)`çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä¼ å…¥Applicationçš„contextï¼Œè€Œä¸æ˜¯ä¼ å…¥Activityæˆ–è€…Fragmentã€‚
æ­¤å¤–ï¼Œè€ƒè™‘åˆ°é•¿æ—¶é—´çš„åŠ è½½æ“ä½œå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼Œè¯·è€ƒè™‘ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œè€Œä¸æ˜¯åŒ¿åå†…éƒ¨ç±»ã€‚

### ViewTarget
å¦‚æœä½ æƒ³åŠ è½½ä¸€ä¸ªå›¾ç‰‡åˆ°Viewä¸­ï¼Œä½†æ˜¯ä½ æƒ³è§‚å¯Ÿæˆ–è€…è¦†ç›–Glideçš„é»˜è®¤è¡Œä¸ºã€‚ä½ å¯ä»¥è¦†ç›–ViewTargetæˆ–è€…å®ƒçš„å­ç±»ã€‚
å½“ä½ æƒ³è®©Glideæ¥è·å–viewçš„çš„å¤§å°ï¼Œä½†æ˜¯ç”±è‡ªå·±æ¥å¯åŠ¨åŠ¨ç”»å’Œè®¾ç½®èµ„æºåˆ°viewä¸­ï¼ŒViewTargetæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚å¦‚æœä½ è¦åŠ è½½ä¸€ä¸ªå›¾ç‰‡åˆ°ImageViewä¹‹å¤–çš„è‡ªå®šä¹‰viewä¸­ï¼Œé‚£ä¹ˆImageViewTargetæˆ–è€…å®ƒçš„å­ç±»å°±ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œæ­¤æ—¶ç»§æ‰¿ViewTargetå°±ç‰¹åˆ«åˆé€‚ã€‚
ä½ å¯ä»¥é™æ€çš„å®šä¹‰ä¸€ä¸ªViewTargetçš„å­ç±»ï¼Œæˆ–è€…ä¼ é€’ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»åˆ°ä½ çš„åŠ è½½è°ƒç”¨é‡Œï¼š

```java
Glide.with(yourFragment)
    .load(yourUrl)
    .into(new ViewTarget<YourViewClass, GlideDrawable>(yourViewObject) {
        @Override
        public void onResourceReady(GlideDrawable resource, GlideAnimation anim) {
            YourViewClass myView = this.view;
            // Set your resource on myView and/or start your animation here.
        }
    });
```
æ³¨æ„ï¼Œå¦‚æœä½ æƒ³æŒ‡å®šåŠ è½½Bitmapè¿˜æ˜¯GifDrawableï¼Œè¯·åœ¨`.load(yourUrl)`è°ƒç”¨åé¢ç›´æ¥æ·»åŠ `.asBitmap()`æˆ–è€…`.asGif()`ï¼ŒåŒæ—¶å°†ViewTargetçš„ç±»å‹å‚æ•°`GlideDrawable`æ¢æˆå¯¹åº”åŠ è½½çš„ç±»å‹ã€‚
ä¸ºäº†æ›´å¤šæ§åˆ¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨Targetå®ç°`LifecycleListener`å›è°ƒï¼Œ`onStart()`ã€`onStop()`æˆ–è€…`onDestroy()`ä¼šå’Œä½ viewæ‰€åœ¨çš„fragmentçš„ç”Ÿå‘½å‘¨æœŸä¿æŒåŒæ­¥ã€‚

### è¦†ç›–é»˜è®¤è¡Œä¸º
å¦‚æœä½ åªæƒ³è§‚å¯Ÿä¸æƒ³ä¿®æ”¹Glideçš„é»˜è®¤è¡Œä¸ºï¼Œä½ å¯ä»¥ç»§æ‰¿ä»»ä½•ä¸€ä¸ªGlideå¯¹ImageViewTargetsçš„é»˜è®¤å®ç°ã€‚

* GlideDrawableImageViewTarget - é»˜è®¤çš„Targetï¼Œç”¨äºæ­£å¸¸çš„åŠ è½½å’Œ`asGif()`ã€‚
* BitmapImageViewTarget - å½“ä½¿ç”¨`asBitmap()`åŠ è½½æ—¶ï¼Œä½¿ç”¨çš„é»˜è®¤Targetã€‚

åªæœ‰ä½ åœ¨æ¯ä¸ªæ–¹æ³•é‡Œé¢è°ƒç”¨`super()`ï¼Œå°†ä¼šä¿ç•™é»˜è®¤çš„è¡Œä¸ºï¼ŒåŒæ—¶è¿˜å¯ä»¥æ·»åŠ ä¸€äº›ä½ å¸Œæœ›çš„åŠŸèƒ½ã€‚

ä¾‹å¦‚ï¼Œæƒ³è¦ç”Ÿæˆä¸€ä¸ª[è°ƒè‰²æ¿](http://chris.banes.me/2014/07/04/palette-preview/)ï¼Œä½ å¯ä»¥è¿™æ ·åšã€‚

```java
Glide.with(yourFragment) 
    .load(yourUrl) 
    .asBitmap() 
    .into(new BitmapImageViewTarget(yourImageView)) { 
        @Override 
        public void onResourceReady(Bitmap bitmap, GlideAnimation anim) {
            super.onResourceReady(bitmap, anim);
            Palette.generateAsync(bitmap, new Palette.PaletteAsyncListener() {  
                @Override 
                public void onGenerated(Palette palette) {
                    // Here's your generated palette 
                } 
            }); 
        } 
    }); 
```
è™½ç„¶è¿™ä¸ªä¾‹å­è¿˜ä¸é”™ï¼Œä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä¸æ¨èç”¨è¿™ä¸ªæ–¹å¼ç”Ÿæˆè°ƒè‰²æ¿ã€‚è¯·æŸ¥çœ‹Glideçš„ `ResourceTranscoder` æ¥å£å’Œ`.transcode()`æ–¹æ³•ï¼Œè€ƒè™‘è¿”å›ä¸€ä¸ªåŒ…å«Bitmapå’Œè°ƒè‰²æ¿çš„è‡ªå®šä¹‰èµ„æºã€‚è°ƒè‰²æ¿å¯åœ¨åœ¨åå°çº¿ç¨‹ç”Ÿæˆã€‚ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿæ›´å¤šå†…å®¹ä¼šåœ¨ä»¥åæ¨å‡ºã€‚ã€‚ã€‚

---------

## è°ƒè¯•å’Œé”™è¯¯å¤„ç†
Glideåœ¨åŠ è½½è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šæ‰“æ—¥å¿—ã€‚Glideä¸ºä½ æä¾›äº†ä¸¤ç§æ–¹å¼æŸ¥çœ‹å’Œå¤„ç†è¿™äº›å¼‚å¸¸ã€‚

### è°ƒè¯•
ä»…ä»…ä¸ºäº†æŸ¥çœ‹å¼‚å¸¸çš„è¯ï¼Œä½ å¯ä»¥ä¸º`GenericRequest`ç±»æ‰“å¼€Debugæ—¥å¿—ã€‚è¿™ä¸ªç±»å¤„ç†æ‰€æœ‰åª’ä½“èµ„æºçš„åŠ è½½å“åº”ï¼ˆresponseï¼‰ã€‚ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œè¿è¡Œï¼š

```xml
adb shell setprop log.tag.GenericRequest DEBUG
```
æƒ³è¦åŒ…æ‹¬è¯¦ç»†çš„è¯·æ±‚æ—¶åºä¿¡æ¯ï¼Œä½ å¯ä»¥æŠŠ`DEBUG`ç¼“å­˜`VERBOSE`ã€‚

å…³é—­æ—¥å¿—ä½¿ç”¨ï¼š

```xml
adb shell setprop log.tag.GenericRequest ERROR
```

### è°ƒè¯•[å·¥ä½œæµ](https://docs.google.com/drawings/d/1KyOJkNd5Dlm8_awZpftzW7KtqgNR6GURvuF6RfB210g/edit)
ä¸ºäº†æŸ¥çœ‹å†…éƒ¨å¼•æ“ï¼ˆengineï¼‰å¦‚ä½•ä»¥åŠä½•æ—¶æŸ¥æ‰¾åˆ°èµ„æºï¼Œä½ å¯ä»¥æ‰“å¼€æ—¥å¿—ï¼š

```xml
adb shell setprop log.tag.Engine VERBOSE
adb shell setprop log.tag.EngineJob VERBOSE
adb shell setprop log.tag.DecodeJob VERBOSE
```
æ‰“å¼€è¿™ä¸ªæœ‰åŠ©äºä½ æ‰¾å‡ºä¸ºä»€ä¹ˆæŸä¸ªèµ„æºæ²¡æœ‰ä»å†…å­˜ç¼“å­˜ä¸­åŠ è½½ï¼Œä¸ºä»€ä¹ˆè¯·æ±‚å†æ¬¡ä»å¤–éƒ¨çš„urlä¸‹è½½æ•°æ®ã€‚è¿™ä¹Ÿå¯ä»¥å¸®åŠ©ä½ äº†è§£ï¼šå¦‚æœæƒ³å‘½ä¸­ç£ç›˜ç¼“å­˜ï¼Œä»€ä¹ˆæ ·çš„å‚æ•°éœ€è¦åŒ¹é…ã€‚å¯ç”¨`DecodeJob`æ—¥å¿—ä¹Ÿå¯ä»¥å¸®åŠ©ä½ å»å®šä½è‡ªå®šä¹‰transformation/decoder/encoderç›¸å…³çš„é—®é¢˜ã€‚

### ç›‘å¬è¯·æ±‚-RequestListener
è™½ç„¶å¯ç”¨debugæ—¥å¿—å¾ˆç®€å•ï¼Œä½†æ˜¯åªæœ‰åœ¨ä½ å¯ä»¥è¿æ¥åˆ°è®¾å¤‡æ—¶æ‰èƒ½è¿™æ ·å¹²ã€‚ä¸ºäº†æŠŠGlideé›†æˆåˆ°å·²æœ‰çš„æ›´ä¸“ä¸šçš„é”™è¯¯æ—¥å¿—ç³»ç»Ÿã€‚ä½ å¯ä»¥ä½¿ç”¨`RequestListener`ç±»çš„`onException()`ã€‚å½“è¯·æ±‚å¤±è´¥æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šå‘ŠçŸ¥ä½ å¯¼è‡´å¤±è´¥çš„`å¼‚å¸¸`(Exception)ï¼Œå¦‚æœè§£ç å™¨ï¼ˆDecoderï¼‰ä¸èƒ½ä»æ•°æ®ä¸­è§£æå‡ºä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯ï¼ŒExceptionä¹Ÿå¯èƒ½ä¼ `null`ã€‚ä½ å¯ä»¥ä½¿ç”¨`listener()`APIä¼ ä¸€ä¸ªä½ çš„ç›‘å¬å™¨ï¼ˆlistenerï¼‰åˆ°æ¯ä¸€ä¸ªè¯·æ±‚ä¸­ã€‚
è¯·ç¡®ä¿`onException()`è¿”å›`false`ï¼Œä»¥å…è¦†ç›–äº†Glideçš„é»˜è®¤é”™è¯¯å¤„ç†è¡Œä¸ºï¼ˆä¾‹å¦‚ï¼Œå®ƒé»˜è®¤ä¼šé€šçŸ¥`Target`è¿™ä¸ªerrorï¼‰ã€‚
è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿè°ƒè¯•çš„ä¾‹å­ï¼š

```java
// example usage: .listener(new LoggingListener<String, GlideDrawable>()) 
public class LoggingListener<T, R> implements RequestListener<T, R> {
    @Override public boolean onException(Exception e, Object model, Target target, boolean isFirstResource) {
        android.util.Log.d("GLIDE", String.format(Locale.ROOT,
                "onException(%s, %s, %s, %s)", e, model, target, isFirstResource), e);
        return false; 
    } 
    @Override public boolean onResourceReady(Object resource, Object model, Target target, boolean isFromMemoryCache, boolean isFirstResource) {
        android.util.Log.d("GLIDE", String.format(Locale.ROOT,
                "onResourceReady(%s, %s, %s, %s, %s)", resource, model, target, isFromMemoryCache, isFirstResource));
        return false; 
    } 
} 
```
**ç¡®ä¿å‘ç‰ˆå‰ç§»é™¤ç›¸å…³ä»£ç **

### æ›´å¤šæ—¥å¿—
è¿™ä¸ªåˆ—è¡¨æ˜¯ç»™3.6.0ç‰ˆæœ¬ç”¨çš„ï¼Œå¯èƒ½ä¸å®Œæ•´ã€‚

```xml
cd .../android-sdk/platform-tools
adb shell setprop log.tag.AnimatedGifEncoder VERBOSE
adb shell setprop log.tag.AssetUriFetcher VERBOSE
adb shell setprop log.tag.BitmapEncoder VERBOSE
adb shell setprop log.tag.BufferedIs VERBOSE
adb shell setprop log.tag.ByteArrayPool VERBOSE
adb shell setprop log.tag.CacheLoader VERBOSE
adb shell setprop log.tag.ContentLengthStream VERBOSE
adb shell setprop log.tag.DecodeJob VERBOSE
adb shell setprop log.tag.DiskLruCacheWrapper VERBOSE
adb shell setprop log.tag.Downsampler VERBOSE
adb shell setprop log.tag.Engine VERBOSE
adb shell setprop log.tag.EngineRunnable VERBOSE
adb shell setprop log.tag.GenericRequest VERBOSE
adb shell setprop log.tag.GifDecoder VERBOSE
adb shell setprop log.tag.GifEncoder VERBOSE
adb shell setprop log.tag.GifHeaderParser VERBOSE
adb shell setprop log.tag.GifResourceDecoder VERBOSE
adb shell setprop log.tag.Glide VERBOSE
adb shell setprop log.tag.ImageHeaderParser VERBOSE
adb shell setprop log.tag.ImageVideoDecoder VERBOSE
adb shell setprop log.tag.IVML VERBOSE
adb shell setprop log.tag.LocalUriFetcher VERBOSE
adb shell setprop log.tag.LruBitmapPool VERBOSE
adb shell setprop log.tag.MediaStoreThumbFetcher VERBOSE
adb shell setprop log.tag.MemorySizeCalculator VERBOSE
adb shell setprop log.tag.PreFillRunner VERBOSE
adb shell setprop log.tag.ResourceLoader VERBOSE
adb shell setprop log.tag.RMRetriever VERBOSE
adb shell setprop log.tag.StreamEncoder VERBOSE
adb shell setprop log.tag.TransformationUtils VERBOSE
```

---------

## ä½¿ç”¨Glideä¸‹è½½è‡ªå®šä¹‰å¤§å°çš„å›¾ç‰‡
å¼€å‘è€…å¯ä»¥é€šè¿‡Glideçš„ModelLoaderæ¥å£è·å¾—å›¾ç‰‡å¤§å°ï¼Œå¹¶æ ¹æ®è¿™ä¸ªå¤§å°æ¥åŠ è½½ä¸€ä¸ªåˆé€‚å°ºå¯¸çš„å›¾ç‰‡urlã€‚
ä½¿ç”¨åˆé€‚å°ºå¯¸çš„å›¾ç‰‡å¯ä»¥èŠ‚çº¦å¸¦å®½ï¼Œè®¾å¤‡çš„å­˜å‚¨ç©ºé—´ï¼Œè¿˜å¯ä»¥æå‡appæ€§èƒ½ã€‚
2014å¹´çš„Google I/O appå›¢é˜Ÿå†™äº†ä¸€ç¯‡å…³äºå¦‚ä½•ä½¿ç”¨ModelLoaderæ¥å£è°ƒæ•´åŠ è½½çš„å›¾ç‰‡å¤§å°çš„æ–‡ç« ã€‚è¯·åœ¨GitHubä¸ŠæŸ¥çœ‹ [I/O appçš„æºç ](https://github.com/google/iosched/blob/master/doc/IMAGES.md)ã€‚
ä¸ºäº†å®ç°è‡ªå®šä¹‰çš„ModelLoaderæ¥é€šè¿‡http/httpsä¸‹è½½å›¾ç‰‡ï¼Œå¯ä»¥ç»§æ‰¿BaseGlideUrlLoaderè¿™ä¸ªç±»

```java
public interface MyDataModel { 
    public String buildUrl(int width, int height);
}  
 
public class MyUrlLoader extends BaseGlideUrlLoader<MyDataModel> { 
    @Override 
    protected String getUrl(MyDataModel model, int width, int height) {
        // Construct the url for the correct size here. 
        return model.buildUrl(width, height);
    } 
} 
```

ç„¶åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ModelLoaderæ¥åŠ è½½å›¾ç‰‡äº†ï¼Œå…¶ä»–çš„äº‹æƒ…ä¼šè‡ªåŠ¨å®Œæˆï¼š

```java
Glide.with(yourFragment)
    .using(new MyUrlLoader())
    .load(yourModel)
    .into(yourView);
```

å¦‚æœä½ æƒ³é¿å…è°ƒç”¨`.using(new  MyUrlLoader())`ï¼Œä½ å¯ä»¥å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„`ModelLoaderFactory`ï¼Œå¹¶åœ¨`GlideModule`ä¸­æ³¨å†Œå®ƒã€‚

```java
public class MyGlideModule implements GlideModule { 
    ... 
    @Override 
    public void registerComponents(Context context, Glide glide) {
        glide.register(MyDataModel.class, InputStream.class, 
            new MyUrlLoader.Factory()); 
    } 
} 
```

æ³¨å†ŒModelLoaderFactoryä¹‹åï¼Œä½ å°±ä¸ç”¨è°ƒç”¨`.using()`äº†ï¼š

```java
Glide.with(yourFragment)
    .load(yourModel)
    .into(yourView);
```

å…¶ä»–çš„ä¾‹å­ï¼Œå…³äºå¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰ModelLoaderåŠ è½½å„ç§å°ºå¯¸çš„å›¾ç‰‡ï¼Œè¯·æŸ¥çœ‹[Flickerç¤ºä¾‹åº”ç”¨](https://github.com/bumptech/glide/blob/master/samples/flickr/src/main/java/com/bumptech/glide/samples/flickr/FlickrModelLoader.java)ï¼Œå’Œ[Giphyç¤ºä¾‹åº”ç”¨](https://github.com/bumptech/glide/blob/master/samples/giphy/src/main/java/com/bumptech/glide/samples/giphy/GiphyModelLoader.java)ã€‚

---------

## é›†æˆï¼ˆIntegrationï¼‰åº“-Glideä¸å…¶ä»–åº“æ•´åˆ

### ä»‹ç»

####ä»€ä¹ˆæ˜¯é›†æˆåº“ï¼ˆIntegration Libraryï¼‰
GlideåŒ…æ‹¬ä¸€ç³»åˆ—å°å·§å¯é…ç½®çš„é›†æˆåº“ï¼Œè¿™äº›åº“å¯ä»¥è®©Glideä¸å¤–éƒ¨çš„åº“ç›¸ç»“åˆã€‚ç°åœ¨é›†æˆåº“å¯ä»¥ä½¿Glideæ”¯æŒVolleyå’ŒOkHttpçš„http/httpsè¯·æ±‚ã€‚

æˆ‘ä»¬åšä¿¡ï¼Œæ‚¨æ‰€é€‰æ‹©çš„å®¢æˆ·ç«¯åª’ä½“åº“æ—¢ä¸åº”è¯¥å†³å®šä½ åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ç½‘ç»œåº“ï¼Œä¹Ÿä¸éœ€è¦ä½ ä»…ä»…ä¸ºäº†åŠ è½½å›¾åƒé¢å¤–æ·»åŠ ç½‘ç»œåº“ã€‚é›†æˆåº“å’ŒGlideçš„ModelLoaderç³»ç»Ÿï¼Œå…è®¸å¼€å‘äººå‘˜å¯¹æ‰€æœ‰ç½‘ç»œè¯·æ±‚ä½¿ç”¨ç»Ÿä¸€çš„ç½‘ç»œåº“ã€‚

#### ä¸ºä»€ä¹ˆæ²¡æœ‰XXXåº“çš„å®ç°
å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ä¸ºè¿™ä¸ªåº“å†™é›†æˆåº“ã€‚OkHttpå’ŒVolleyæ˜¯ååˆ†æµè¡Œçš„åº“ï¼Œè®¸å¤šå¼€å‘è€…éƒ½ä½¿ç”¨ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸æ˜¯æ’æ–¥å…¶ä»–åº“ï¼Œå¦‚æœä½ å†™äº†å…¶ä»–åº“çš„`ModelLoader`å¹¶ä¸”æ‰“ç®—å¼€æºï¼Œæˆ‘ä»¬å¾ˆä¹æ„çœ‹åˆ°è¿™æ ·çš„æäº¤è¯·æ±‚ï¼ˆpull requestï¼‰ã€‚

#### æˆ‘å¦‚ä½•ä¾èµ–ä¸€ä¸ªé›†æˆåº“å‘¢ï¼Ÿ
ä¾èµ–ä»»ä½•çš„é›†æˆåº“éœ€è¦ä¸¤gä¸ªæ­¥éª¤ã€‚

1. æ·»åŠ ç›¸åº”çš„ç»§æ‰¿åº“çš„Maven/Gradle/jarä¾èµ–ï¼Œå› ä¸ºä½œä¸ºå¯é€‰é¡¹çš„é›†æˆåº“å¹¶ä¸åŒ…å«åœ¨glideçš„jarä¾èµ–ä¸­ã€‚
2. ç¡®ä¿appåŒ…å«äº†é›†æˆåº“çš„GlideModuleï¼Œå…·ä½“å†…å®¹çœ‹[é…ç½®wiki](https://github.com/bumptech/glide/wiki/Configuration)éƒ¨åˆ†ã€‚å¯¹äºGlideé›†æˆåº“çš„å…·ä½“è¯´æ˜è§ä¸‹é¢ã€‚

#### æˆ‘åº”å½“é€‰æ‹©å“ªä¸ªç‰ˆæœ¬ï¼Ÿ
é›†æˆåº“çš„ç‰ˆæœ¬è·Ÿéšç€Glideçš„releaseç‰ˆæœ¬ã€‚ä½†æ˜¯å¤šäº†ä¸€ä¸ªä¸åŒçš„æ•°å­—ã€‚ç¡®ä¿é€‰æ‹©ä¸æ‰€ä¾èµ–çš„Glideå¯¹åº”çš„é›†æˆåº“ã€‚åœ¨[releaseé¡µ](https://github.com/bumptech/glide/releases)æŸ¥çœ‹.
ç½‘ç»œåº“æœ‰è‡ªå·±çš„ç‰ˆæœ¬å·ã€‚ç»§æ‰¿åº“ä¼šä¾èµ–çš„åº“å°±æ˜¯ä½ åœ¨Maven/Gradleä¸­æŒ‡å®šçš„åº“ã€‚ä½ å¯ä»¥é€šè¿‡ç‰ˆæœ¬å·æ¥æŒ‡å®šå…·ä½“ä¾èµ–çš„ç½‘ç»œåº“ã€‚ï¼Ÿï¼Ÿ

### Volley
Volleyæ˜¯ä¸€ä¸ªHttpåº“ï¼Œå¯ä»¥ä½¿Androidä¸Šçš„ç½‘ç»œè¯·æ±‚æ›´ç®€å•ï¼Œæ›´å¿«é€Ÿã€‚

#### Gradleä¸­ä½¿ç”¨Volley

```java
dependencies {
    compile 'com.github.bumptech.glide:volley-integration:1.3.1@aar'
    //compile 'com.mcxiaoke.volley:library:1.0.8'
}
```
é›†æˆåº“çš„`GlideModule`ä¼šè‡ªåŠ¨åˆå¹¶åˆ°ä½ appçš„manifestä¸­ã€‚

#### Mavenä¸­æ˜¯Volley

```xml
<dependency>
    <groupId>com.github.bumptech.glide</groupId>
    <artifactId>volley-integration</artifactId>
    <version>1.3.1</version>
    <type>aar</type>
</dependency>
<dependency>
    <groupId>com.mcxiaoke.volley</groupId>
    <artifactId>library</artifactId>
    <version>1.0.8</version>
    <type>aar</type>
</dependency>

```
è¯·æŸ¥çœ‹å¯¹åº”çš„manifestç« èŠ‚ï¼Œäº†è§£å¦‚ä½•æ·»åŠ å¯¹åº”çš„GlideModuleã€‚

#### æ‰‹åŠ¨æ·»åŠ Volley
ä»[releaseé¡µ](https://github.com/bumptech/glide/releases)ä¸‹è½½[glide-volley-integration-<version>.jar ](https://github.com/bumptech/glide/releases/download/v3.6.1/glide-volley-integration-1.3.1.jar)ã€‚å¹¶æ·»åŠ åˆ°ä½ appçš„ç¼–è¯‘è·¯å¾„ä¸­(compile classpath)ã€‚

è¯·æŸ¥çœ‹å¯¹åº”çš„manifestç« èŠ‚ï¼Œäº†è§£å¦‚ä½•æ·»åŠ å¯¹åº”çš„GlideModuleã€‚

#### Volleyçš„Manifest
å¦‚æœä½ ä½¿ç”¨é‚£äº›ä¸æ”¯æŒmanifeståˆå¹¶çš„ç¼–è¯‘ç³»ç»Ÿï¼ˆå¦‚Mavenï¼ŒAntï¼‰ï¼Œä½ å¿…é¡»æ‰‹åŠ¨æ·»åŠ `GlideModule`çš„metadataæ ‡ç­¾åˆ°`AndroidManifest.xml`ä¸­ã€‚

```xml
<meta-data
    android:name="com.bumptech.glide.integration.volley.VolleyGlideModule"
    android:value="GlideModule" />
```

#### Volleyçš„æ··æ·†è®¾ç½®
æ— è®ºä½¿ç”¨ä»€ä¹ˆç¼–è¯‘ç³»ç»Ÿï¼Œä¸è¦æ··æ·†`VolleyGlideModule`ç±»ï¼Œå®ƒéœ€è¦è¢«åå°„æ¥å®ä¾‹åŒ–ã€‚æ·»åŠ ä¸‹é¢çš„ä»£ç åˆ°`proguard.cfg`æ–‡ä»¶ï¼ˆæˆ–è€…æŸ¥çœ‹â€œé€šç”¨éƒ¨åˆ†â€ï¼‰ã€‚

```java
-keep class com.bumptech.glide.integration.volley.VolleyGlideModule
```

### OkHttp
OKHttpæ˜¯ä¸€ä¸ªé«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„Httpå®¢æˆ·ç«¯ã€‚

#### Gradleä¸­ä½¿ç”¨OkHttp

```java
dependencies {
    compile 'com.github.bumptech.glide:okhttp-integration:1.3.1@aar'
    //compile 'com.squareup.okhttp:okhttp:2.2.0'
}
```
é›†æˆåº“çš„`GlideModule`ä¼šè‡ªåŠ¨åˆå¹¶åˆ°ä½ appçš„manifestä¸­ã€‚

#### Mavenä¸­æ˜¯OkHttp

```xml
<dependency>
    <groupId>com.github.bumptech.glide</groupId>
    <artifactId>okhttp-integration</artifactId>
    <version>1.3.1</version>
    <type>aar</type>
</dependency>
<!--
<dependency>
    <groupId>com.squareup.okhttp</groupId>
    <artifactId>okhttp</artifactId>
    <version>2.2.0</version>
    <type>jar</type>
</dependency>
-->

```
è¯·æŸ¥çœ‹å¯¹åº”çš„manifestç« èŠ‚ï¼Œäº†è§£å¦‚ä½•æ·»åŠ å¯¹åº”çš„GlideModuleã€‚

#### æ‰‹åŠ¨æ·»åŠ OkHttp
ä»[releaseé¡µ](https://github.com/bumptech/glide/releases)ä¸‹è½½[glide-okhttp-integration-<version>.jar ](https://github.com/bumptech/glide/releases/download/v3.6.1/glide-okhttp-integration-1.3.1.jar)ã€‚å¹¶æ·»åŠ åˆ°ä½ appçš„ç¼–è¯‘è·¯å¾„ä¸­(compile classpath)ã€‚

è¯·æŸ¥çœ‹å¯¹åº”çš„manifestç« èŠ‚ï¼Œäº†è§£å¦‚ä½•æ·»åŠ å¯¹åº”çš„GlideModuleã€‚

#### OkHttpçš„Manifest
å¦‚æœä½ ä½¿ç”¨é‚£äº›ä¸æ”¯æŒmanifeståˆå¹¶çš„ç¼–è¯‘ç³»ç»Ÿï¼ˆå¦‚Mavenï¼ŒAntï¼‰ï¼Œä½ å¿…é¡»æ‰‹åŠ¨æ·»åŠ `GlideModule`çš„metadataæ ‡ç­¾åˆ°`AndroidManifest.xml`ä¸­ã€‚

```xml
<meta-data
    android:name="com.bumptech.glide.integration.okhttp.OkHttpGlideModule"
    android:value="GlideModule" />
```

#### OkHttpçš„æ··æ·†è®¾ç½®
æ— è®ºä½¿ç”¨ä»€ä¹ˆç¼–è¯‘ç³»ç»Ÿï¼Œä¸è¦æ··æ·†`OkHttpGlideModule`ç±»ï¼Œå®ƒéœ€è¦è¢«åå°„æ¥å®ä¾‹åŒ–ã€‚æ·»åŠ ä¸‹é¢çš„ä»£ç åˆ°`proguard.cfg`æ–‡ä»¶ï¼ˆæˆ–è€…æŸ¥çœ‹â€œé€šç”¨éƒ¨åˆ†â€ï¼‰ã€‚

```java
-keep class com.bumptech.glide.integration.okhttp.OkHttpGlideModule
```

### æ›´å¤šé€‰é¡¹

#### é€šç”¨çš„æ··æ·†é…ç½®
ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„é…ç½®æ¥é¿å…æ··æ·†æ‰€æœ‰çš„`GlideModule`ã€‚

```java
-keep public class * implements com.bumptech.glide.module.GlideModule
```
è¿™ç§æ–¹å¼æœ‰å…¶ä»–çš„å¥½å¤„ï¼Œå½“ä¿®æ”¹é›†æˆåº“æˆ–è€…è‡ªå®šä¹‰é›†æˆåº“çš„è¡Œä¸ºæ—¶ï¼Œä¸éœ€è¦ä¿®æ”¹ã€‚å½“ä½ æ·»åŠ æˆ–è€…ç§»åŠ¨å…¶ä»–moduleçš„æ—¶å€™ï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹ä»€ä¹ˆã€‚

#### è¦†ç›–é»˜è®¤çš„è¡Œä¸º
å¦‚æœé»˜è®¤é…ç½®æ— æ³•æ»¡è¶³ä½ ï¼Œæ‰€æœ‰çš„é›†æˆåº“è¿˜æœ‰ä¸€äº›é¢å¤–çš„é€‰é¡¹ã€‚æ¯”å¦‚æ·»åŠ é‡è¯•è¡Œä¸ºï¼Œè¯·æŸ¥çœ‹é›†æˆåº“çš„`GlideModule`çš„æºç ï¼ˆä½äº[/integration/<lib>/src/main/java/<package>](https://github.com/bumptech/glide/tree/3.0/integration)ï¼‰äº†è§£é»˜è®¤çš„æ³¨å†Œåšäº†äº›ä»€ä¹ˆã€‚ä½ å¯ä»¥é€šè¿‡åœ¨è‡ªå®šä¹‰çš„`GlideModule`ä¸­ä¿®æ”¹å‚æ•°ä¸º`UrlLoader.Factory`ç±»æ¥æ”¹å˜é»˜è®¤è¡Œä¸ºã€‚
å½“ä½ è¦è¦†ç›–é»˜è®¤è¡Œä¸ºæ—¶ï¼Œè¯·ç¡®ä¿è‡ªå®šä¹‰çš„`GlideModule`è¢«æ³¨å†Œï¼Œä¸”é»˜è®¤çš„GlideModuleè¢«æ’é™¤åœ¨å¤–ã€‚æ’é™¤GlideModuleå¯èƒ½æ˜¯ä»manifestä¸­ç§»é™¤ç›¸åº”çš„çš„metadataï¼Œæˆ–è€…ä½¿ç”¨jaråŒ…ä¾èµ–ä»£æ›¿aarä¾èµ–ã€‚å…³äº`GlideModule`çš„æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹[é…ç½®çš„wikié¡µ](https://github.com/bumptech/glide/wiki/Configuration)\

---------

## åœ¨åå°çº¿ç¨‹ä¸­åŠ è½½å’Œç¼“å­˜
ä¸ºäº†ä½¿åå°åŠ è½½èµ„æºå’Œä¸åª’ä½“äº¤äº’æ›´åŠ å®¹æ˜“ï¼Œé™¤äº†`Glide.with(fragment).load(url).into(view)`è¿™ä¸ªAPIå¤–ï¼ŒGlideè¿˜æä¾›äº†é¢å¤–ä¸¤ä¸ªAPIã€‚

* `downloadOnly(int, int)`
* `into(int, int)`

### downloadOnlyæ–¹æ³•
Glideçš„`downloadOnly(int, int)`æ–¹æ³•å…è®¸ä½ æŠŠå›¾ç‰‡bytesä¸‹è½½åˆ°ç£ç›˜ç¼“å­˜ä¸­ï¼Œä»¥ä¾¿ä»¥åè·å–ä½¿ç”¨ã€‚ä½ å¯ä»¥åœ¨UIçº¿ç¨‹å¼‚æ­¥åœ°è°ƒç”¨`downloadOnly()`ï¼Œä¹Ÿå¯ä»¥åœ¨åå°çº¿ç¨‹åŒæ­¥çš„ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œæ³¨æ„ä»–ä»¬çš„å‚æ•°æœ‰äº›ä¸åŒï¼Œå¼‚æ­¥APIçš„å‚æ•°æ˜¯`Target`ï¼ŒåŒæ­¥apiçš„å‚æ•°æ˜¯å®½å’Œé«˜çš„æ•´æ•°å€¼ã€‚	
ä¸ºäº†åœ¨åå°çº¿ç¨‹ä¸‹è½½å›¾ç‰‡ï¼Œä½ å¿…é¡»ä½¿ç”¨åŒæ­¥æ–¹æ³•

```java
FutureTarget<File> future = Glide.with(applicationContext)
    .load(yourUrl)
    .downloadOnly(500, 500);
File cacheFile = future.get();
```
å½“futureè¿”å›æ—¶ï¼Œå›¾ç‰‡çš„bytesæ•°æ®å°±åœ¨ç¼“å­˜ä¸­å¯ç”¨äº†ã€‚ä¸€ç§å…¸å‹çš„æƒ…å†µæ˜¯ï¼Œä½ ä½¿ç”¨`downloadOnly()`APIåªæ˜¯ä¸ºäº†ç¡®ä¿æ•°æ®ä¸‹è½½åˆ°äº†ç£ç›˜ä¸Šã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè™½ç„¶ä½ æœ‰æƒè®¿é—®åº•å±‚çš„ç¼“å­˜æ–‡ä»¶ï¼Œä½†æ˜¯ä½ ä¸éœ€è¦ç›´æ¥å’Œå®ƒäº¤äº’ã€‚
è€Œæ˜¯ï¼Œå½“ä½ æƒ³è¦è·å–è¿™ä¸ªå›¾ç‰‡æ—¶ï¼Œä½ åªè¦åƒå¹³å¸¸åŠ è½½å›¾ç‰‡æ—¶é‚£æ ·è°ƒç”¨å°±è¡Œï¼Œ**åªæœ‰ä¸€ç‚¹ä¸åŒ**ï¼š

```java
Glide.with(yourFragment)
    .load(yourUrl)
    .diskCacheStrategy(DiskCacheStrategy.ALL)
    .into(yourView);
```
é€šè¿‡ä¼ å…¥ `DiskCacheStrategy.ALL`æˆ–è€…`DiskCacheStrategy.SOURCE`ï¼Œç¡®ä¿Glideå¯ä»¥ä½¿ç”¨ä½ é€šè¿‡`downloadOnly()`ä¸‹è½½çš„æ•°æ®ã€‚

### intoæ–¹æ³•
å¦‚æœä½ æƒ³åœ¨ä¸€ä¸ª**åå°çº¿ç¨‹**ä¸ä¸€å¼ å·²ç»è§£ç çš„å›¾ç‰‡äº¤äº’ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„`into()`æ–¹æ³•æ¥è¿”å›ä¸€ä¸ª`FutureTarget`ã€‚ä¾‹å¦‚ï¼Œè·å–ä¸€å¼ ä¸­å¿ƒå‰ªè£åçš„500*500åƒç´ çš„å›¾ç‰‡ï¼š

```java
Bitmap myBitmap = Glide.with(applicationContext)
    .load(yourUrl)
    .asBitmap()
    .centerCrop()
    .into(500, 500)
    .get()
```
è™½ç„¶`into(int, int)`æ–¹æ³•åœ¨åå°çº¿ç¨‹ä¸­å¾ˆæœ‰æ•ˆï¼Œä½†æ˜¯ï¼Œä½ ä¸èƒ½æŠŠå®ƒç”¨åœ¨ä¸»çº¿ç¨‹ä¸­ã€‚å³ä½¿è¿™ä¸ªåŒæ­¥æ–¹æ³•åœ¨ä½ çš„ä¸»çº¿ç¨‹ä¸­ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè°ƒç”¨get()ä¹Ÿä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚ä¼šä½¿ä½ çš„APPæ€§èƒ½å˜å·®ï¼Œååº”è¿Ÿé’ã€‚

---------

## Glideä¸­çš„èµ„æºå¤ç”¨

### ä¸ºä»€ä¹ˆ - èµ„æºå¤ç”¨çš„ä½œç”¨
Glideé€šè¿‡å¤ç”¨èµ„æºé¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…ã€‚Dalvikè™šæ‹Ÿæœºï¼ˆåœ¨Lollipopä¹‹å‰ï¼‰æœ‰ä¸¤ç§åŸºæœ¬çš„åƒåœ¾å›æ”¶æ–¹å¼ï¼Œ`GC_CONCURRENT` å’Œ`GC_FOR_ALLOC`ã€‚æ¯æ¬¡`GC_CONCURRENT`ä¼šé˜»å¡ä¸»çº¿ç¨‹5msã€‚ç”±äºæ¯æ¬¡æ“ä½œçš„æ—¶é—´å°‘äº16msï¼ˆ1å¸§çš„æ—¶é—´ï¼‰ï¼Œ`GC_CONCURRENT`å¹¶ä¸ä¼šå¼•èµ·æ‰å¸§ã€‚ç›¸åçš„æ˜¯`GC_FOR_ALLOC`ï¼Œä»–ä¼šåœæ­¢æ‰€æœ‰æ“ä½œï¼Œé˜»å¡ä¸»çº¿ç¨‹125+msï¼Œäº‹å®ä¸Šï¼ŒGC_FOR_ALLOCæ€»æ˜¯ä¼šè®©ä½ çš„appæ‰å¾ˆå¤šå¸§ã€‚å°¤å…¶æ˜¯åœ¨æ»‘åŠ¨æ—¶ï¼Œå¯¼è‡´æ˜æ˜¾çš„å¡é¡¿ã€‚
å¾ˆä¸å¹¸ï¼Œå³ä½¿åªæ˜¯åˆ†é…é€‚å½“çš„ç©ºé—´ï¼ˆæ¯”å¦‚16kbçš„bufferï¼‰Dalvikè¡¨ç°çš„ä¹Ÿå¾ˆç³Ÿç³•ã€‚ä¸æ–­çš„å°å†…å­˜åˆ†é…ï¼Œæˆ–è€…ä¸€æ¬¡å¤§çš„å†…å­˜åˆ†é…ï¼ˆæ¯”å¦‚è¯´bitmapï¼‰ï¼Œå°†ä¼šå¼•èµ·GC_FOR_ALLOCã€‚å› æ­¤ï¼Œä½ åˆ†é…å†…å­˜çš„è¶Šå¤šï¼Œä½ ä¼šé‡åˆ°åƒåœ¾å›æ”¶å™¨é˜»å¡åº”ç”¨çš„æƒ…å†µå°±è¶Šå¤šï¼Œåº”ç”¨æ‰å¸§å°±è¶Šä¸¥é‡ã€‚
é€šè¿‡é€‚åº¦å¤ç”¨å¤§å—èµ„æºï¼ŒGlideå¯ä»¥é¿å…å†…å­˜æŠ–åŠ¨ï¼Œå‡å°‘åƒåœ¾å›æ”¶å™¨é˜»å¡appçš„æ¬¡æ•°ã€‚

### æ€ä¹ˆåš - Glideæ˜¯å¦‚ä½•å¤ç”¨èµ„æº
Glideçš„èµ„æºå¤ç”¨ç­–ç•¥æ¯”è¾ƒå®½æ¾ã€‚è¿™æ„å‘³ç€ï¼Œå½“Glideè®¤ä¸ºè¯¥èµ„æºå¯ä»¥è¢«å®‰å…¨çš„å¤ç”¨æ—¶ï¼Œæ‰æœ‰å‡ ç‡å»å¤ç”¨å®ƒï¼Œå¹¶ä¸éœ€è¦å¼€å‘è€…åœ¨æ¯ä¸ªrequeståé¢å»æ‰‹åŠ¨é‡Šæ”¾èµ„æºã€‚

#### æ ‡å¿—-å“ªäº›èµ„æºå¯å¤ç”¨
Glideæœ‰ä¸¤ä¸ªç®€å•çš„æ ‡å¿—æ¥è¯†åˆ«å¯å¤ç”¨çš„èµ„æºã€‚

1. `Glide.clear()` 

	åœ¨`View`æˆ–è€…`Target`ä¸Šè°ƒç”¨`clear()`æ–¹æ³•éƒ½è¡¨ç¤ºï¼ŒGlideè¦å–æ¶ˆåŠ è½½ï¼Œå¯ä»¥å®‰å…¨åœ°æŠŠTargetå ç”¨çš„æ‰€æœ‰èµ„æºï¼ˆBitmapï¼Œbytesæ•°ç»„ç­‰ï¼‰æ”¾å…¥èµ„æºæ± ä¸­ï¼ˆpoolï¼‰ã€‚ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•æ—¶å€™å®‰å…¨åœ°æ‰‹åŠ¨è°ƒç”¨`clear()`æ–¹æ³•ï¼Œä½†æ˜¯å…¸å‹æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿™æ ·åšï¼Œçœ‹ç¬¬äºŒæ¡ã€‚

2. Viewæˆ–è€…Targetçš„å¤ç”¨ 

	å½“ç”¨æˆ·æŠŠå›¾ç‰‡åŠ è½½åˆ°ä¸€ä¸ªå·²ç»å­˜åœ¨çš„Viewæˆ–è€…Targetä¸Šæ—¶ï¼ˆæ³¨ï¼šç¡®åˆ‡çš„è¯´æ˜¯è°ƒç”¨`into(xxx)`æ–¹æ³•ä¹‹åï¼‰ï¼ŒGlideä¼šå…ˆè°ƒç”¨`clear()`æ¸…ç©ºè¯¥View/Targetä¸Šçš„åŠ è½½è¯·æ±‚å¹¶å¤ç”¨å·²ç»æ˜¾ç¤ºè¿‡çš„èµ„æºã€‚å› æ­¤ï¼Œå¦‚æœä½ çš„ListViewæˆ–è€…RecyclerViewä¸­çš„viewä½¿ç”¨äº†å¤ç”¨æœºåˆ¶ï¼ˆæ³¨ï¼šå¦‚ViewHolderï¼‰ï¼Œé‚£ä¹ˆGlideä¼šè‡ªåŠ¨ä¸ºä»–ä»¬ç¼“å­˜èµ„æºå’Œç®¡ç†åŠ è½½è¯·æ±‚ã€‚
 
#### å¼•ç”¨è®¡æ•°
å¦‚æœä¸¤ä¸ªè¯·æ±‚æŒ‡å‘åŒä¸€ä¸ªèµ„æºï¼Œä¸ºäº†é¿å…é¢å¤–çš„å·¥ä½œï¼ŒGlideä¼šæŠŠå•ä¸ªèµ„æºåˆ†é…ç»™ä»–ä»¬ã€‚è¿™å°±å¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œå½“Glideå¾—çŸ¥æŸä¸ªèµ„æºä¸è¢«æŸä¸ªè°ƒç”¨è€…ä½¿ç”¨ï¼Œè¿™å¹¶ä¸è¡¨ç¤ºå®ƒä¸ä¼šè¢«å…¶ä»–è°ƒç”¨è€…ä½¿ç”¨ã€‚ä¸ºäº†é¿å…å›æ”¶è°ƒä¾æ—§è¢«ä½¿ç”¨çš„èµ„æºï¼ŒGlideä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥è·Ÿè¸ªèµ„æºã€‚
å½“æŠŠèµ„æºæä¾›ç»™View/Targetæ—¶ï¼Œè¯¥èµ„æºçš„å¼•ç”¨è®¡æ•°åŠ 1ï¼Œå½“æ¸…ç©ºView/Targetæ—¶ï¼Œå¼•ç”¨è®¡æ•°å‡1ã€‚å½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼ŒGlideä¼šå›æ”¶èµ„æºï¼Œå¹¶æŠŠå®ƒçš„å†…å®¹æ”¾å›å¯ç”¨å†…å­˜æ± ä¸­ã€‚

#### æ”¾å…¥ç¼“å­˜æ± 
Glideçš„Resource APIæœ‰ä¸€ä¸ª`recycle()`æ–¹æ³•ï¼Œå½“Glideè®¤ä¸ºèµ„æºä¸å†è¢«å¼•ç”¨æ—¶ï¼Œä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œèµ„æºä¼šæ”¾å…¥ç¼“å­˜æ± ä¸­ã€‚

Glideæä¾›çš„BitmapPoolæ¥å£å¯ä»¥è®©Resourceè·å–`Bitmap`å’Œå¤ç”¨Bitmapå¯¹è±¡ã€‚Glideçš„BitmapPoolå¯ä»¥é€šè¿‡Glideå•ä¾‹è·å¾—ï¼š

```java
Glide.get(context).getBitmapPool();
```
ResourceDecoderå¯ä»¥è¿”å›Resourceçš„ä»»ä½•å®ç°ã€‚æ‰€æœ‰ï¼Œå¼€å‘è€…å¯ä»¥å®ç°ä»–ä»¬è‡ªå·±çš„Resourceå’ŒResourceDecoderæ¥è‡ªå®šä¹‰åœ°ç¼“å­˜ä¸€äº›ç‰¹æœ‰ç±»å‹çš„æ•°æ®ã€‚
åŒæ ·åœ°ï¼Œå¼€å‘è€…å¦‚æœæƒ³æ›´å¤šåœ°æ§åˆ¶Bitmapç¼“å­˜ï¼Œå¯ä»¥å®ç°è‡ªå·±çš„BitmapPoolï¼Œç„¶åé€šè¿‡GlideModuleé…ç½®åˆ°Glideä¸­ã€‚

### å¸¸è§çš„é”™è¯¯
ä¸å¹¸çš„æ˜¯ï¼Œç¼“å­˜æ± è®¾è®¡ä½¿æˆ‘ä»¬å¾ˆéš¾åˆ¤æ–­å¼€å‘è€…æ˜¯å¦è¯¯ç”¨äº†èµ„æºæˆ–è€…bitmapã€‚ä½†æ˜¯ï¼Œåœ¨Glideä¸­æœ‰ä¸¤ä¸ªä¸»è¦çš„ç°è±¡ä¼šæš—ç¤ºä½ æŸäº›åœ°æ–¹å¯èƒ½å‡ºäº†é—®é¢˜ã€‚

#### ç°è±¡

1. `Cannot draw a recycled Bitmap`

	Glideæœ‰ä¸ªå›ºå®šå¤§å°çš„Bitmapæ± ã€‚å½“Bitmapä¸å†è¢«å¤ç”¨ï¼ˆæ³¨ï¼šä¸æ˜¯ä½¿ç”¨ï¼ŒåŒºåˆ†ä½¿ç”¨å’Œå¤ç”¨ï¼‰ï¼Œä¼šä»æ± ä¸­ç§»èµ°ã€‚Glideä¼šè°ƒç”¨[`recycle()`](http://developer.android.com/reference/android/graphics/Bitmap.html#recycle())ï¼ˆæ³¨ï¼šæŒ‡çš„æ˜¯BitmapçœŸæ­£çš„recycleï¼Œä¸æ˜¯Resourceç±»çš„recycleï¼‰ã€‚ä½ å‘Šè¯‰Glideæ”¾å¿ƒåœ°å›æ”¶æŸä¸ªBitmapï¼Œä½†æ˜¯ï¼Œä½ çš„åº”ç”¨ä¸å°å¿ƒè¿˜æŒæœ‰è¿™ä¸ªBitmapçš„å¼•ç”¨ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½ä¼šç»˜åˆ¶è¿™ä¸ªBitmapï¼Œå¯¼è‡´å´©æºƒã€‚

2. Viewåœ¨å¤šå¼ å›¾ç‰‡ä¹‹é—´é—ªçƒï¼Œæˆ–è€…åŒæ ·çš„å›¾ç‰‡å‡ºç°åœ¨å¤šä¸ªViewä¸­

	å¦‚æœä¸€å¼ å›¾ç‰‡è¢«æ”¾å…¥BitmapPoolä¸­å¤šæ¬¡ã€‚æˆ–è€…è™½ç„¶ä¸€å¼ å›¾ç‰‡è¢«æ”¾å…¥äº†poolä¸­ï¼Œä½†æ˜¯æŸä¸ªViewä¾ç„¶æŒæœ‰è¿™ä¸ªå›¾çš„å¼•ç”¨ï¼Œä¸æ­¤åŒæ—¶ï¼Œå¦ä¸€å¼ å›¾ç‰‡è¢«è§£ææˆäº†Bitmapï¼ˆæ³¨ï¼šæ­¤Bitmapæ­£å¥½ç”¨äº†åˆšæ‰é‚£å¼ å›¾ç‰‡çš„æ§ä»¶æ¥å­˜æ”¾è§£æåçš„æ•°æ®ï¼‰ã€‚å¦‚æœå‘ç”Ÿè¿™ç§äº‹æƒ…ï¼ŒBitmapçš„å†…å®¹å°±ä¼šè¢«æ¢æˆäº†æ–°çš„å›¾ç‰‡å†…å®¹ã€‚æ­¤æ—¶ï¼ŒViewä¾ç„¶å°è¯•ç€ç»˜åˆ¶Bitmapï¼Œå¯¼è‡´åŸæ¥çš„Viewä¸­æ˜¾ç¤ºäº†ä¸€å¼ æ–°çš„å›¾ç‰‡ï¼

#### åŸå› 
è¿™äº›é—®é¢˜ä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š

1. å°è¯•åŠ è½½ä¸¤ä¸ªä¸åŒçš„èµ„æºåˆ°åŒä¸€Targetä¸­

	åœ¨Glideä¸­ï¼Œæ²¡æœ‰å®‰å…¨çš„æ–¹æ³•æ¥åŠ è½½å¤šä¸ªèµ„æºåˆ°å•ä¸€çš„Targetä¸­ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨`thumbnail()`æ¥åŠ è½½ä¸€ç³»åˆ—èµ„æºåˆ°åˆ°æŸä¸ªTargetä¸­ï¼Œä½†æ˜¯å¯¹äºæ¯ä¸€ä¸ªåŠ è½½çš„èµ„æºæ¥è¯´ï¼Œåªæœ‰åœ¨ä¸‹ä¸€ä¸ª`onResourceReady()`è¢«è°ƒç”¨å‰ï¼Œå®ƒçš„å¼•ç”¨æ‰æ˜¯å®‰å…¨çš„ã€‚
å¼€å‘è€…å¦‚æœæƒ³åŠ è½½å¤šä¸ªèµ„æºåˆ°åŒä¸€ä¸ªViewä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„Targetã€‚ä¸ºäº†ç¡®ä¿åŠ è½½è¿‡ç¨‹ä¸ç›¸äº’å–æ¶ˆï¼Œå¼€å‘è€…è¦ä¹ˆä¸ä½¿ç”¨ViewTargetçš„å­ç±»ï¼Œè¦ä¹ˆåœ¨ç»§æ‰¿ViewTargetæ—¶ï¼Œå¤å†™`setRequest()` å’Œ `getRequest()`ï¼Œä¸è¦ä½¿ç”¨tagæ¥å­˜å‚¨Requestã€‚ï¼ˆæ³¨ï¼šéœ€è¦ä¸€ä¸ªdemo)

	**è¯‘è€…æ³¨ï¼šå¯¹äºåŒä¸€ä¸ªviewï¼Œè°ƒç”¨ä¸¤æ¬¡Glide.xxx.into(view)ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨ä¼šå…ˆæ¸…ç©ºç¬¬ä¸€ä¸ªåŠ è½½çš„å›¾ç‰‡ï¼ˆå‡ºç°ç©ºç™½ï¼‰ï¼Œå†å»ä¸‹è½½æ–°çš„å›¾ç‰‡ï¼Œå¦‚æœæƒ³è¦åœ¨ç¬¬äºŒå¼ å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ä¹‹å‰ä¾æ—§æ˜¾ç¤ºä¹‹å‰çš„ï¼Œéœ€è¦ä¸€äº›æŠ€å·§**
2. åŠ è½½ä¸€ä¸ªèµ„æºæ”¾å…¥åˆ°Targetï¼Œç„¶åæ¸…ç©ºæˆ–è€…å¤ç”¨äº†Targetï¼Œä½†æ˜¯ä¾ç„¶å¼•ç”¨è¿™è¿™ä¸ªèµ„æºã€‚

	æœ€ç®€å•çš„é¿å…è¿™ä¸ªé”™è¯¯çš„æ–¹æ³•æ˜¯åœ¨`onLoadCleared()`æ–¹æ³•ä¸­æŠŠæ‰€æœ‰å¯¹èµ„æºå¯¹è±¡çš„å¼•ç”¨ç½®nullã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŠ è½½ä¸€ä¸ªBitmapï¼Œç„¶åå¼•ç”¨å®ƒçš„Targetæ˜¯å®‰å…¨çš„ã€‚ä¸å®‰å…¨çš„æ˜¯ï¼Œä½ æ¸…ç©ºäº†è¿™ä¸ªTargetï¼Œå´ä¾ç„¶å¼•ç”¨ç€è¿™ä¸ªBitmapã€‚
	
---------
	
## ä½¿ç”¨å¿«ç…§

### å…³äºå¿«ç…§
å¯¹äºé‚£äº›ä¸æƒ³ç­‰å¾…Glideä¸‹ä¸ªæ­£å¼ç‰ˆæœ¬è€Œæ„¿æ„å°é²œçš„ç”¨æˆ·ï¼Œæˆ‘ä»¬åœ¨[Sonatype](https://travis-ci.org/bumptech/glide)ä¸Šéƒ¨ç½²äº†è¿™ä¸ªåº“çš„å¿«ç…§ã€‚
æ¯ä¸€æ¬¡æˆ‘ä»¬pushä»£ç å¾…GitHubçš„masteråˆ†æ”¯ï¼Œ[travis-ci](https://oss.sonatype.org/content/repositories/snapshots/)ä¼šæ„å»ºGlide.å¦‚æœæ„å»ºæˆåŠŸï¼Œä¼šè‡ªåŠ¨éƒ¨ç½²æœ€æ–°ç‰ˆæœ¬çš„åº“åˆ°Sonatypeä¸Šã€‚
å’ŒGlideä¸»åº“ä¸€æ ·ï¼Œæ¯ä¸ªIntergrationåº“ä¹Ÿæœ‰è‡ªå·±çš„å¿«ç…§ï¼Œå¦‚æœä½ ä½¿ç”¨å¿«ç…§ç‰ˆæœ¬çš„Glideåº“ï¼Œè¯·ä½¿ç”¨å¿«ç…§ç‰ˆæœ¬çš„Intergrationåº“ï¼Œåä¹‹ä¾ç„¶ã€‚

### è·å–å¿«ç…§
Sonatypeçš„å¿«ç…§åº“å’Œå…¶ä»–çš„mavenåº“ä¸€æ ·ï¼Œæä¾›jarï¼Œmavenï¼Œgradleç­‰ç‰ˆæœ¬ã€‚

#### Jar
JaråŒ…å¯ä»¥ç›´æ¥ä»Sonatypeä¸Šä¸‹è½½ï¼Œå†æ¬¡æ£€æŸ¥ä¸€ä¸‹æ—¥æœŸï¼Œç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬

#### Gradle
åœ¨ä»“åº“åˆ—è¡¨ä¸­æ·»åŠ å¿«ç…§ä»“åº“

```xml
repositories {
  jcenter()
  maven {
    url 'http://oss.sonatype.org/content/repositories/snapshots'
  }
}
```
ç„¶åä¿®æ”¹ä¾èµ–ä¸ºå¿«ç…§ç‰ˆæœ¬

```xml
dependencies {
  compile "com.github.bumptech.glide:glide:3.6.0-SNAPSHOT"
  compile "com.github.bumptech.glide:okhttp-integration:1.3.0-SNAPSHOT"
}
```

#### Maven
è¿™ç§æ–¹å¼æ²¡æœ‰æµ‹è¯•ï¼Œç›´æ¥ä»[StackOverflow](http://stackoverflow.com/questions/7715321/how-to-download-snapshot-version-from-maven-snapshot-repository)æ‹·è¿‡æ¥çš„ã€‚æ¬¢è¿æ”¹è¿›ä¸‹é¢çš„å†…å®¹ã€‚
æ·»åŠ ä¸‹é¢çš„ä»£ç åˆ°`~/.m2/settings.xml`ä¸­ï¼š

```xml
<profiles>
  <profile>
     <id>allow-snapshots</id>
     <activation><activeByDefault>true</activeByDefault></activation>
     <repositories>
       <repository>
         <id>snapshots-repo</id>
         <url>https://oss.sonatype.org/content/repositories/snapshots</url>
         <releases><enabled>false</enabled></releases>
         <snapshots><enabled>true</enabled></snapshots>
       </repository>
     </repositories>
   </profile>
</profiles>
```
ä¿®æ”¹ä¾èµ–ä¸ºå¿«ç…§ç‰ˆæœ¬

```xml
<dependency>
  <groupId>com.github.bumptech.glide</groupId>
  <artifactId>glide</artifactId>
  <version>3.6.0-SNAPSHOT</version>
</dependency>
<dependency>
  <groupId>com.github.bumptech.glide</groupId>
  <artifactId>okhttp-integration</artifactId>
  <version>1.3.0-SNAPSHOT</version>
</dependency>
```

---------

## å›¾å½¢å˜æ¢

### é»˜è®¤çš„å˜æ¢
GlideåŒ…å«ä¸¤ç§é»˜è®¤çš„å›¾åƒå˜æ¢æ–¹å¼ï¼ŒfitCenterå’ŒcenterCropã€‚å¦‚æœå¼€å‘è€…éœ€è¦å…¶ä»–ç±»å‹çš„å˜æ¢ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ä¸ªç‹¬ç«‹çš„[å˜æ¢åº“](https://github.com/wasabeef/glide-transformations)ã€‚

#### Fit center
FitCenterä¼šæŒ‰åŸå§‹æ¯”ä¾‹ç¼©å°å›¾åƒï¼Œä½¿å›¾åƒå¯ä»¥åœ¨æ”¾åœ¨ç»™å®šçš„åŒºåŸŸå†…ã€‚FitCenterä¼šå°½å¯èƒ½å°‘åœ°ç¼©å°å›¾ç‰‡ï¼Œä½¿å®½æˆ–è€…é«˜çš„ä¸€è¾¹ç­‰äºç»™å®šçš„å€¼ã€‚å¦å¤–ä¸€è¾¹ä¼šç­‰äºæˆ–è€…å°äºç»™å®šå€¼ã€‚
FitCenterå’ŒAndroidä¸­çš„ScaleType.FIT_CENTERæ•ˆæœç›¸åŒã€‚
#### CenterCrop
CenterCropä¼šæŒ‰åŸå§‹æ¯”ä¾‹ç¼©å°å›¾åƒï¼Œä½¿å®½æˆ–è€…é«˜çš„ä¸€è¾¹ç­‰äºç»™å®šçš„å€¼ï¼Œå¦å¤–ä¸€è¾¹ä¼šç­‰äºæˆ–è€…å¤§äºç»™å®šå€¼ã€‚CenterCropä¼šè£å‰ªæ‰å¤šä½™éƒ¨åˆ†ã€‚
CenterCropå’ŒAndroidä¸­çš„ScaleType.CENTER_CROPæ•ˆæœç›¸åŒã€‚

### ä½¿ç”¨
fit centeræ•ˆæœä½¿ç”¨`.fitCenter()`ï¼š

```java
Glide.with(yourFragment)
    .load(yourUrl)
    .fitCenter()
    .into(yourView);
```
center cropæ•ˆæœä½¿ç”¨`.centerCrop()`ï¼š

```java
Glide.with(yourFragment)
    .load(yourUrl)
    . centerCrop()
    .into(yourView);
```
å¦‚æœä½ åªåŠ è½½Bitmapæˆ–è€…Gifï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªå˜æ¢ï¼š

```java
// For Bitmaps:
Glide.with(yourFragment)
    .load(yourUrl)
    .asBitmap()
    .centerCrop()
    .into(yourView);

// For gifs:
Glide.with(yourFragment)
    .load(yourUrl)
    .asGif()
    .fitCenter()
    .into(yourView);
```
å½“åœ¨ç±»å‹é—´è½¬ç æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿™äº›å˜æ¢ã€‚ä¾‹å¦‚ï¼Œè·å–ä¸€ä¸ªå˜å½¢åçš„jpegå›¾ç‰‡çš„bytesæ•°æ®ï¼š

```java
Glide.with(yourFragment)
    .load(yourUrl)
    .asBitmap()
    .toBytes()
    .centerCrop()
    .into(new SimpleTarget<byte[]>(...) { ... });

```
è‡ªå®šä¹‰å˜æ¢
é™¤äº†ä¸¤ä¸ªå†…ç½®çš„å˜æ¢ï¼Œä½ è¿˜å¯ä»¥è‡ªå®šä¹‰å˜æ¢ã€‚
æœ€ç®€å•çš„æ–¹å¼æ˜¯ç»§æ‰¿BitmapTransformationã€‚

```java
private static class MyTransformation extends BitmapTransformation { 
 
    public MyTransformation(Context context) {
       super(context);
    } 
 
    @Override 
    protected Bitmap transform(BitmapPool pool, Bitmap toTransform, 
            int outWidth, int outHeight) {
       Bitmap myTransformedBitmap = ... // apply some transformation here. 
       return myTransformedBitmap; 
    } 
 
    @Override 
    public String getId() {
        // Return some id that uniquely identifies your transformation. 
        return "com.example.myapp.MyTransformation"; 
    } 
} 
```

ä¹‹åä¸€å°±å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚ä½¿ç”¨`.transform(...)`ä»£æ›¿`.fitCenter()`/`.centerCrop()`ã€‚

```java
// For the default drawable type:
Glide.with(yourFragment)
    .load(yourUrl)
    .transform(new MyTransformation(context))
    .into(yourView);

// For Bitmaps:
Glide.with(yourFragment)
    .load(yourUrl)
    .asBitmap()
    .transform(new MyTransformation(context))
    .into(yourView);

// For Gifs:
Glide.with(yourFragment)
    .load(yourUrl)
    .asGif()
    .transform(new MyTransformation(context))
    .into(yourView);
```

#### è°ƒæ•´å¤§å°
ä½ å¯èƒ½æ³¨æ„åˆ°ä¸Šé¢çš„ä¾‹å­æ²¡æœ‰ä¼ å…¥å…·ä½“çš„å°ºå¯¸ï¼Œé‚£ä¹ˆï¼ŒTransformationä¸­çš„å°ºå¯¸æ˜¯å¦‚ä½•è·å¾—çš„å‘¢ï¼Ÿ
Transformationä¸­çš„å°ºå¯¸å°±æ˜¯Viewæˆ–è€…Targetçš„å¤§å°ã€‚Glideä¼šæ ¹æ®å¸ƒå±€æ–‡ä»¶ä¸­çš„weightï¼Œmatch_parentæˆ–è€…å…·ä½“å€¼ç®—å‡ºViewçš„å¤§å°ã€‚ï¼Œå½“ä½ æ‹¥æœ‰View/Targetçš„å…·ä½“å¤§å°ï¼Œåˆæ‹¥æœ‰åŸå§‹å›¾ç‰‡çš„å¤§å°æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡å›¾åƒå˜æ¢ç”Ÿæˆä¸€ä¸ªæ­£ç¡®å¤§å°çš„å›¾ç‰‡ã€‚
å¦‚æœä½ æƒ³æŒ‡å®šView/Targetçš„è‡ªå®šä¹‰å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨`.override(int, int)`æ–¹æ³•ï¼Œå¦‚æœä½ æƒ³åŠ è½½ä¸€ä¸ªå›¾ç‰‡æœ‰å…¶ä»–ç”¨é€”ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºåœ¨Viewä¸­ï¼Œè¯·æŸ¥çœ‹ã€è‡ªå®šä¹‰Targetã€ç« èŠ‚ã€‚

#### Bitmap å¤ç”¨
ä¸ºäº†å‡å°‘åƒåœ¾å›æ”¶ï¼Œä½ å¯ä»¥è¯´ä½¿ç”¨`BitmapPool`æ¥å£æ¥é‡Šæ”¾ä¸æƒ³è¦çš„Bitmapæˆ–è€…å¤ç”¨å­˜åœ¨çš„Bitmapã€‚ä¸€ä¸ªåœ¨Transformationä¸­å¤ç”¨Bitmapå…¸å‹çš„ä¾‹å­ï¼šä»poolä¸­è·å–Bitmapï¼Œä½¿ç”¨è¯¥Bitmapåˆ›å»ºä¸€ä¸ª`Canvas`ï¼Œç„¶åä½¿ç”¨Matrix/Paint/Shaderæ¥å˜æ¢å›¾åƒå¹¶ç»˜åˆ¶åˆ°Canvasä¸Šã€‚ä¸ºäº†æ­£ç¡®æœ‰æ•ˆåœ°åœ¨Transformationä¸­å¤ç”¨Bitmapä¸­ï¼Œéµå®ˆä¸‹é¢çš„è§„åˆ™ï¼š

1. åœ¨`transform()`ä¸è¦å›æ”¶èµ„æºæˆ–è€…æŠŠBitmapæ”¾å…¥Bitmapæ± ä¸­ï¼Œè¿™äº›æ­¥éª¤ä¼šè‡ªåŠ¨å®Œæˆã€‚
2. å¦‚æœä½ ä»Bitmapæ± ä¸­è·å–äº†å¤šä¸ªBitmapï¼Œæˆ–è€…æ²¡æœ‰ä½¿ç”¨ä»poolä¸­è·å–åˆ°çš„Bitmapï¼Œç¡®ä¿æŠŠå¤šä½™çš„Bitmapæ”¾å›poolä¸­ã€‚
3. å¦‚æœä½ çš„Trasformationå¹¶æ²¡æœ‰æ›¿æ¢è°ƒåŸå§‹å›¾ç‰‡ï¼ˆæ¯”å¦‚ï¼Œå›¾ç‰‡å·²ç»æ»¡è¶³ä½ è¦æ±‚çš„å¤§å°ï¼Œç›´æ¥è¿”å›äº†ï¼‰ï¼Œè¯·åœ¨`transform()`æ–¹æ³•ä¸­è¿”å›åŸå§‹çš„èµ„æºæˆ–è€…Bitmapã€‚

ä¸€ä¸ªå…¸å‹çš„ç”¨æ³•å¦‚ä¸‹ï¼š

```java
protected Bitmap transform(BitmapPool bitmapPool, Bitmap original, int width, int height) {
    Bitmap result = bitmapPool.get(width, height, Bitmap.Config.ARGB_8888);
    // If no matching Bitmap is in the pool, get will return null, so we should allocate. 
    if (result == null) {
        // Use ARGB_8888 since we're going to add alpha to the image. 
        result = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
    } 
    // Create a Canvas backed by the result Bitmap. 
    Canvas canvas = new Canvas(result);
    Paint paint = new Paint();
    paint.setAlpha(128);
    // Draw the original Bitmap onto the result Bitmap with a transformation. 
    canvas.drawBitmap(original, 0, 0, paint);
    // Since we've replaced our original Bitmap, we return our new Bitmap here. Glide will 
    // will take care of returning our original Bitmap to the BitmapPool for us.  
    return result;
} 
```